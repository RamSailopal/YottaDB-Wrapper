<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5. General Language Features of M &mdash; Programmer&#39;s Guide  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Commands" href="commands.html" />
    <link rel="prev" title="4. Operating and Debugging in Direct Mode" href="opdebug.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
	  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
		      <input type="text" name="q" placeholder="Search" />
		          <input type="hidden" name="check_keywords" value="yes" />
			      <input type="hidden" name="area" value="default" />
			        </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://yottadb.com/resources/documentation">Main YottaDB Documentation Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="man.html">About this Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">1. About YottaDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="langext.html">2. YottaDB Language Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="devcycle.html">3. Development Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="opdebug.html">4. Operating and Debugging in Direct Mode</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="langfeat.html#">5. General Language Features of M</a><ul>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#data-types">Data Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#numeric-expressions">Numeric Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#numeric-accuracy">Numeric Accuracy</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#integer-expressions">Integer Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#truth-valued-expressions">Truth Valued Expressions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#m-names">M Names</a></li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#variables">Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#arrays-and-subscripts">Arrays and Subscripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#m-collation-sequences">M Collation Sequences</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#null-subscripts-and-collation">Null Subscripts and Collation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="langfeat.html#null-subscripts">Null Subscripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="langfeat.html#null-subscript-collation">Null Subscript Collation</a></li>
<li class="toctree-l4"><a class="reference internal" href="langfeat.html#gde">GDE</a></li>
<li class="toctree-l4"><a class="reference internal" href="langfeat.html#dse">DSE</a></li>
<li class="toctree-l4"><a class="reference internal" href="langfeat.html#m-commands-functions">M Commands/Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="langfeat.html#mupip-binary-extract-and-load">MUPIP Binary Extract and Load</a></li>
<li class="toctree-l4"><a class="reference internal" href="langfeat.html#replication">Replication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#local-variables">Local Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#global-variables-and-resource-name-environments">Global Variables and Resource Name Environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#naked-references">Naked References</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#global-variable-name-environments">Global Variable Name Environments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="langfeat.html#optional-yottadb-environment-translation-facility">Optional YottaDB Environment Translation Facility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#literals">Literals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#string-literals">String Literals</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#numeric-literals">Numeric Literals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#expressions">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#operators">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#precedence">Precedence</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#arithmetic-operators">Arithmetic Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#logical-operators">Logical Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#string-operators">String Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#numeric-relational-operators">Numeric Relational Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#string-relational-operators">String Relational Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#pattern-match-operator">Pattern Match Operator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#id3">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#postconditionals">Postconditionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#timeouts">Timeouts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#m-locks">M Locks</a></li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#intrinsic-functions">Intrinsic Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#id5">Intrinsic Special Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#routines">Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#lines">Lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#entry-references">Entry References</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#label-references">Label References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#indirection">Indirection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#argument-indirection">Argument Indirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#atomic-indirection">Atomic Indirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#entryref-indirection">Entryref Indirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#pattern-code-indirection">Pattern Code Indirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#name-indirection">Name Indirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#indirection-concerns">Indirection Concerns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#parameter-passing">Parameter Passing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#actuallists">Actuallists</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#actualnames">Actualnames</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#formallists">Formallists</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#formallabel">Formallabel</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#parameter-passing-operation">Parameter Passing Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#parameter-passing-mechanisms">Parameter Passing Mechanisms</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#parameter-passing-extensions">Parameter Passing Extensions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#external-calls">External Calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#extrinsic-functions">Extrinsic Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#extrinsic-special-variables">Extrinsic Special Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="langfeat.html#transaction-processing">Transaction Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#tp-definitions">TP Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#key-considerations-writing-tp-code">Key Considerations - Writing TP Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#tp-performance">TP Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="langfeat.html#tp-example">TP Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">6. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">7. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="isv.html">8. Intrinsic Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioproc.html">9. Input/Output Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility.html">10. Utility Routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="extrout.html">11. Integrating External Routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="internatn.html">12. Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="errproc.html">13. Error Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="triggers.html">14. Triggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="encrypt.html">15. Database Encryption Extensions to the YottaDB External Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix A: M Coding Standards - Do’s and Don’ts</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">LICENSE</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Programmer's Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>5. General Language Features of M</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="opdebug.html" class="btn btn-neutral float-left" title="4. Operating and Debugging in Direct Mode" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="commands.html" class="btn btn-neutral float-right" title="6. Commands" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="general-language-features-of-m">
<span id="index-0"></span><h1><a class="toc-backref" href="langfeat.html#id10">5. General Language Features of M</a><a class="headerlink" href="langfeat.html#general-language-features-of-m" title="Permalink to this heading">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="langfeat.html#general-language-features-of-m" id="id10">5. General Language Features of M</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#data-types" id="id11">Data Types</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#numeric-expressions" id="id12">Numeric Expressions</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#numeric-accuracy" id="id13">Numeric Accuracy</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#integer-expressions" id="id14">Integer Expressions</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#truth-valued-expressions" id="id15">Truth Valued Expressions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#m-names" id="id16">M Names</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#variables" id="id17">Variables</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#arrays-and-subscripts" id="id18">Arrays and Subscripts</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#m-collation-sequences" id="id19">M Collation Sequences</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#null-subscripts-and-collation" id="id20">Null Subscripts and Collation</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#null-subscripts" id="id21">Null Subscripts</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#null-subscript-collation" id="id22">Null Subscript Collation</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#gde" id="id23">GDE</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#dse" id="id24">DSE</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#m-commands-functions" id="id25">M Commands/Functions</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#zwrite" id="id26">ZWRITE</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#order" id="id27">$ORDER()</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#zprevious" id="id28">$ZPREVIOUS()</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#query" id="id29">$QUERY()</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#mupip-binary-extract-and-load" id="id30">MUPIP Binary Extract and Load</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#replication" id="id31">Replication</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#local-variables" id="id32">Local Variables</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#global-variables-and-resource-name-environments" id="id33">Global Variables and Resource Name Environments</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#naked-references" id="id34">Naked References</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#global-variable-name-environments" id="id35">Global Variable Name Environments</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#optional-yottadb-environment-translation-facility" id="id36">Optional YottaDB Environment Translation Facility</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#ydb-env-xlate" id="id37">ydb_env_xlate</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#literals" id="id38">Literals</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#string-literals" id="id39">String Literals</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#numeric-literals" id="id40">Numeric Literals</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#expressions" id="id41">Expressions</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#operators" id="id42">Operators</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#precedence" id="id43">Precedence</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#arithmetic-operators" id="id44">Arithmetic Operators</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#logical-operators" id="id45">Logical Operators</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#string-operators" id="id46">String Operators</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#numeric-relational-operators" id="id47">Numeric Relational Operators</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#string-relational-operators" id="id48">String Relational Operators</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#pattern-match-operator" id="id49">Pattern Match Operator</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#id3" id="id50">Commands</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#postconditionals" id="id51">Postconditionals</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#timeouts" id="id52">Timeouts</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#m-locks" id="id53">M Locks</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#intrinsic-functions" id="id54">Intrinsic Functions</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#id5" id="id55">Intrinsic Special Variables</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#routines" id="id56">Routines</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#lines" id="id57">Lines</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#entry-references" id="id58">Entry References</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#label-references" id="id59">Label References</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#indirection" id="id60">Indirection</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#argument-indirection" id="id61">Argument Indirection</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#atomic-indirection" id="id62">Atomic Indirection</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#entryref-indirection" id="id63">Entryref Indirection</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#pattern-code-indirection" id="id64">Pattern Code Indirection</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#name-indirection" id="id65">Name Indirection</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#indirection-concerns" id="id66">Indirection Concerns</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#parameter-passing" id="id67">Parameter Passing</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#actuallists" id="id68">Actuallists</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#actualnames" id="id69">Actualnames</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#formallists" id="id70">Formallists</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#formallabel" id="id71">Formallabel</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#parameter-passing-operation" id="id72">Parameter Passing Operation</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#parameter-passing-mechanisms" id="id73">Parameter Passing Mechanisms</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#parameter-passing-extensions" id="id74">Parameter Passing Extensions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="langfeat.html#external-calls" id="id75">External Calls</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#extrinsic-functions" id="id76">Extrinsic Functions</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#extrinsic-special-variables" id="id77">Extrinsic Special Variables</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#transaction-processing" id="id78">Transaction Processing</a></p>
<ul>
<li><p><a class="reference internal" href="langfeat.html#tp-definitions" id="id79">TP Definitions</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#key-considerations-writing-tp-code" id="id80">Key Considerations - Writing TP Code</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#tp-performance" id="id81">TP Performance</a></p></li>
<li><p><a class="reference internal" href="langfeat.html#tp-example" id="id82">TP Example</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>This chapter describes general features of the M language, as well as general information about the operation of YottaDB. Commands, Functions, and Intrinsic Special Variables are each described in separate chapters. This chapter contains information about exceptions, as well as information about general M features.</p>
<p>M is a general purpose language with an embedded database system. This section describes the features of the language that are not covered in the <a class="reference external" href="commands.html">Commands</a>, <a class="reference external" href="functions.html">Functions</a>, or <a class="reference external" href="isv.html">Intrinsic Special Variables</a> chapters.</p>
<section id="data-types">
<h2><a class="toc-backref" href="langfeat.html#id11">Data Types</a><a class="headerlink" href="langfeat.html#data-types" title="Permalink to this heading">¶</a></h2>
<p>M operates with a single basic data type, string. However, M evaluates data using methods that vary according to context.</p>
<section id="numeric-expressions">
<h3><a class="toc-backref" href="langfeat.html#id12">Numeric Expressions</a><a class="headerlink" href="langfeat.html#numeric-expressions" title="Permalink to this heading">¶</a></h3>
<p>When M syntax specifies a numexpr, M evaluates the data as a sequence of ASCII characters that specify a number. M stops the evaluation and provides the result generated from successfully evaluated characters when it encounters any character that is not the following:</p>
<ul class="simple">
<li><p>A digit 0-9</p></li>
<li><p>A plus sign (+) or minus sign (-) and also the first character in the string</p></li>
<li><p>The first decimal point (.) in the string</p></li>
</ul>
</section>
<section id="numeric-accuracy">
<h3><a class="toc-backref" href="langfeat.html#id13">Numeric Accuracy</a><a class="headerlink" href="langfeat.html#numeric-accuracy" title="Permalink to this heading">¶</a></h3>
<p>YottaDB provides 18 digits of accuracy, independent of the decimal point (.) placement, and a numeric range from 10**(-43) to (10**47). Numbers with three digits or fewer to the right of the decimal point are precise.</p>
</section>
<section id="integer-expressions">
<h3><a class="toc-backref" href="langfeat.html#id14">Integer Expressions</a><a class="headerlink" href="langfeat.html#integer-expressions" title="Permalink to this heading">¶</a></h3>
<p>When M syntax specifies an intexpr, M evaluates the data as it would a numexpr except that it stops the evaluation at any decimal point including the first.</p>
</section>
<section id="truth-valued-expressions">
<h3><a class="toc-backref" href="langfeat.html#id15">Truth Valued Expressions</a><a class="headerlink" href="langfeat.html#truth-valued-expressions" title="Permalink to this heading">¶</a></h3>
<p>When M syntax specifies a tvexpr, M evaluates the data as a numeric. However, it stops the evaluation and returns a true value (1) as soon as it encounters a non-zero digit, otherwise it returns a false value (0). In other words, M treats expressions that have a non-zero numeric value as true, and expressions that have a zero numeric value as false. The sign and/or decimal have no affect on the evaluation of a truth-valued expression.</p>
</section>
</section>
<section id="m-names">
<h2><a class="toc-backref" href="langfeat.html#id16">M Names</a><a class="headerlink" href="langfeat.html#m-names" title="Permalink to this heading">¶</a></h2>
<p>M uses names for variables, LOCK command arguments, labels on lines, and routine names. M names are alphanumeric and must start with an alphabetic character or a percent sign (%).</p>
<p>The percent sign can only appear as the first character in a name. By convention, names starting with percent signs are generally application-independent or distinguished in some similar way.</p>
<p>M does not reserve any names. That is, M always distinguishes keywords by context. Therefore, M permits a variable or a label called SET even though the language has a command called SET.</p>
<p>M names are case sensitive. That is, M treats ABC, Abc, ABc, AbC ABC, and abc as six different names.</p>
<p>M does not restrict the length of names in the main body of the standard. However, the portability section of the standard recommends limiting names to a maximum of eight (8) characters. YottaDB’s limit of 31 characters applies to:</p>
<ul class="simple">
<li><p>Local variable names</p></li>
<li><p>Global variable names</p></li>
<li><p>Routine names</p></li>
<li><p>Source and object file names (not including the extension)</p></li>
<li><p>Label names</p></li>
<li><p>Local lock resource names</p></li>
<li><p>Global lock resource names</p></li>
</ul>
<p>A trigger name is up to 28 characters and a replication instance name is up to 15 characters.</p>
</section>
<section id="variables">
<h2><a class="toc-backref" href="langfeat.html#id17">Variables</a><a class="headerlink" href="langfeat.html#variables" title="Permalink to this heading">¶</a></h2>
<p>M does not require predefinition of variable type or size. M variables are either local or global. Any variable may be unsubscripted or subscripted.</p>
<section id="arrays-and-subscripts">
<h3><a class="toc-backref" href="langfeat.html#id18">Arrays and Subscripts</a><a class="headerlink" href="langfeat.html#arrays-and-subscripts" title="Permalink to this heading">¶</a></h3>
<p>In M, subscripted variables identify elements in sparse arrays. Sparse arrays comprise existing subscripts and data nodes -; no space is reserved for potential data nodes. These arrays generally serve logical, rather than mathematical, purposes.</p>
<p>M array subscripts are expressions, and are not restricted to numeric values.</p>
<p>The format for an M global or local variable is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[^]name[(expr1[,...])]
</pre></div>
</div>
<ul class="simple">
<li><p>The optional leading caret symbol (^) designates a global variable.</p></li>
<li><p>The name specifies a particular array.</p></li>
<li><p>The optional expressions specify the subscripts and must be enclosed in parentheses and separated by commas (,).</p></li>
</ul>
<p>Although there is no restriction on variable names in source code, the first 31 characters of a variable name are significant and subsequent characters are dropped internally. A variable can have up to 31 subscripts. The maximum size of a variable name and all its subscripts is <a class="reference external" href="../AdminOpsGuide/gde.html#guidelines-for-mapping">1,019 bytes</a>.  As this limit is defined by the <a class="reference external" href="../AdminOpsGuide/gds.html#gds-keys">internal representation</a>, it is not easily translated to a specific limit; however, in practice it appears to suffice for most applications. The value of a node can be 1MiB.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As global variables that start with <code class="code docutils literal notranslate"><span class="pre">^%Y</span></code> are used by the
<a class="reference internal" href="utility.html#ygblstat-util"><span class="std std-ref">%YGBLSTAT()</span></a>
utility program, and global variables that start with
<code class="code docutils literal notranslate"><span class="pre">^%y</span></code> are reserved for use by YottaDB,
applications should not use them.</p>
</div>
</section>
<section id="m-collation-sequences">
<h3><a class="toc-backref" href="langfeat.html#id19">M Collation Sequences</a><a class="headerlink" href="langfeat.html#m-collation-sequences" title="Permalink to this heading">¶</a></h3>
<p>M collates all canonic numeric subscripts ahead of all string subscripts, including strings such as those with leading zeros that represent non-canonic numbers. Numeric subscripts collate from negative to positive in value order. String subscripts collate in ASCII sequence. In addition, YottaDB allows the empty string subscript in most contexts (the null, or empty, string collates ahead of all canonic numeric subscripts).</p>
<p>YottaDB allows definition of alternative collation sequences. For complete information on enabling this functionality, See <a class="reference external" href="internatn.html">Chapter 12: “Internationalization”</a>.</p>
</section>
<section id="null-subscripts-and-collation">
<h3><a class="toc-backref" href="langfeat.html#id20">Null Subscripts and Collation</a><a class="headerlink" href="langfeat.html#null-subscripts-and-collation" title="Permalink to this heading">¶</a></h3>
<section id="null-subscripts">
<h4><a class="toc-backref" href="langfeat.html#id21">Null Subscripts</a><a class="headerlink" href="langfeat.html#null-subscripts" title="Permalink to this heading">¶</a></h4>
<p>YottaDB has an option to have databases where existing nodes with null subscripts are accepted, but updates with null subscripts (except Kill) are not allowed. At the same time, an option at database creation time exists to collate null subscripts before numeric and string subscripts, as specified by the M standard.</p>
<p>The NULL SUBSCRIPTS database file header field has the values TRUE, FALSE, ALWAYS (synonymous with TRUE, which is deprecated but continues to be supported), NEVER (synonymous with FALSE, which is also deprecated and also continues to be supported) and EXISTING. Please note that TRUE and ALWAYS are internally the same, as are FALSE and NEVER. This means that GDE and DSE will only display the values as ALWAYS and NEVER.</p>
<p>For any region for which the NULL SUBSCRIPTS field has the value EXISTING:</p>
<ul class="simple">
<li><p>SETs to nodes to that region behave as if the value of the file header field is NEVER/FALSE.</p>
<ul>
<li><p>A SET operation to a global in that region where any subscript of the global is null generates a runtime error.</p></li>
<li><p>A MERGE operation into a global in that region terminates with an error if and when any subscript of any node being set is null.</p></li>
</ul>
</li>
<li><p>Reads (e.g., $GET) from nodes with null subscripts</p>
<ul>
<li><p>If the node has a value, that value is returned. If the value does not exist, a null is returned if VIEW “NOUNDEF” is set, or a runtime error is generated if VIEW “UNDEF” is set.</p></li>
</ul>
</li>
<li><p>Removal of nodes with null subscripts behaves as if the value of the file header field is ALWAYS/TRUE.</p>
<ul>
<li><p>A KILL or ZWITHDRAW operation of a global in that region is permitted, either a direct KILL/ZWITHDRAW of a global any subscript of which is null, or a KILL of a higher-level sub-tree in which one or more nodes have subscripts that are null.</p></li>
</ul>
</li>
</ul>
<p>The DSE FILEHEADER qualifier NULL_SUBSCRIPTS permits the new keywords for values in the NULL_SUBSCRIPTS field. Also, the DSE DUMP command displays the new keywords in the file header output.</p>
<p>The GDE REGION qualifier NULL_SUBSCRIPTS accepts the keywords ALWAYS, NEVER and EXISTING. The existing argument-less qualifiers NULL_SUBSCRIPTS (synonymous with NULL_SUBSCRIPTS=ALWAYS) and NONULL_SUBSCRIPTS (synonymous with -NULL_SUBSCRIPTS=NEVER) are deprecated but continue to be supported. Also, the GDE SHOW command displays the new keywords in the “Null Subs” column.</p>
<p>MUPIP CREATE creates database files with the new values for NULL_SUBSCRIPTS.</p>
</section>
<section id="null-subscript-collation">
<span id="null-subs-colltn"></span><h4><a class="toc-backref" href="langfeat.html#id22">Null Subscript Collation</a><a class="headerlink" href="langfeat.html#null-subscript-collation" title="Permalink to this heading">¶</a></h4>
<p>The default collation (“standard null collation”) of local and global variable subscripts is that the null subscript collates first, followed by numeric subscripts in numeric order, and finally string subscripts in lexical order. YottaDB also supports a historical collation of null subscripts, between numeric subscripts and string subscripts. For global variables, the collation method must be specified at the time of database creation.</p>
<p>A read-only boolean parameter STDNULLCOLL in the database fileheader specifies the type of null collation:</p>
<ul class="simple">
<li><p>If STDNULLCOLL is TRUE, subscripts of globals in the database file place the null subscript before all other subscripts.</p></li>
<li><p>If STDNULLCOLL is set to FALSE, subscripts of globals in the database file place the null subscript between numeric and string subscripts.</p></li>
</ul>
<p>When <a class="reference external" href="../AdminOpsGuide/dbmgmt.html#mupip-create">MUPIP CREATE</a> creates a database file, it initializes the STDNULLCOLL parameter to the collation specified for that region in the global directory.</p>
<p>To establish the null collation method for a specified database, GDE supports a region parameter STDNULLCOLL that can be set to TRUE or FALSE using a region qualifier -STDNULLCOLL or -NOSTDNULLCOLL respectively. These qualifiers are supported with ADD, CHANGE and TEMPLATE commands. When MUPIP creates a new database, the STDNULLCOLL value is copied from the global directory into the database file header.</p>
<p>For M local variables, the null collation can be established either at startup or during run time. Since the same local collation method is established for all locals in a process, changing the null collation within the process is allowed only if there are no local variables defined at that time. At process startup, YottaDB uses the following:</p>
<ul class="simple">
<li><p>Standard null collation if the environment variable <code class="code docutils literal notranslate"><span class="pre">ydb_lct_stdnull</span></code> is undefined, set to either TRUE or YES (or a case-insensitive leading substring thereof), or a non-zero integer.</p></li>
<li><p>Historical null collation if the environment variable <code class="code docutils literal notranslate"><span class="pre">ydb_lct_stdnull</span></code> is set to either FALSE or NO (or a case-insensitive leading substring thereof) or 0.</p></li>
</ul>
<p>To establish a default collation version for local variables within the process, the percent utility %LCLCOL supports establishing the null collation method as well. set^%LCLCOL(col,ncol) accepts an optional parameter ncol that determines the null collation type to be used with the collation type col.</p>
<ul class="simple">
<li><p>If the truth value of ncol is TRUE(1), local variables use standard null collation.</p></li>
<li><p>If the truth value of ncol is FALSE(0), local variables use historical null collation.</p></li>
<li><p>If ncol is not supplied, there is no change to the already established null collation method.</p></li>
</ul>
<p>Also using set^%LCLCOL(,ncol), the null collation order can be changed while keeping the alternate collation order unchanged. If subscripted local variables exist, null collation order cannot be changed. In this case, YottaDB issues YDB-E-COLLDATAEXISTS.</p>
</section>
<section id="gde">
<h4><a class="toc-backref" href="langfeat.html#id23">GDE</a><a class="headerlink" href="langfeat.html#gde" title="Permalink to this heading">¶</a></h4>
<p>The -REGION qualifier –[NO]NULL_SUBCRIPTS accepts new values with change, add and template commands, default is –NONULL_SUBSCRIPTS, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>GDE&gt;add –region areg –dyn<span class="o">=</span>aseg –null_subscripts<span class="o">=</span>always
GDE&gt;change –region areg –null_subscripts<span class="o">=</span><span class="nb">true</span>
GDE&gt;change –region areg –null_subscripts<span class="o">=</span><span class="nb">false</span>
GDE&gt;change –region areg –null_subscripts<span class="o">=</span>never
GDE&gt;change –region areg –null_subscripts<span class="o">=</span>existing
GDE&gt;template –region –null_subscripts<span class="o">=</span>existing
GDE&gt;template –region –nonull_subscripts
</pre></div>
</div>
<p>The other region qualifier is –[NO]STDNULLCOLL with add, change and template command, default is –NOSTDNULLCOLL.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>GDE&gt; template -region -stdnullcoll
GDE&gt; change -region DEFAULT -stdnullcoll
GDE&gt; add -segment TEAGLOBALS -file<span class="o">=</span>TEAGLOBALS.dat
GDE&gt; add -region TEAGLOBALS -dyn<span class="o">=</span>TEAGLOBALS -null_subscripts<span class="o">=</span>existing
GDE&gt; add -name LapsangSouchong -region<span class="o">=</span>TEAGLOBALS
GDE&gt; add -name Darjeeling -region<span class="o">=</span>TEAGLOBALS
GDE&gt; add -name Tea* -region<span class="o">=</span>TEAGLOBALS
GDE&gt; show -all

                          *** Templates ***

Region                             Def Coll     Rec Size    Key Size    Null Subs    Standard Null Coll   Journaling
-----------------------------------------------------------------------------------------------------------------------
&lt;default&gt;                             <span class="m">0</span>          <span class="m">256</span>          <span class="m">64</span>        NEVER               Y                 N


Segment             Active             Acc      Typ    Block                Alloc    Exten     Options
---------------------------------------------------------------------------------------------------------
&lt;default&gt;             *                BG       DYN    <span class="m">1024</span>                 <span class="m">100</span>       <span class="m">100</span>      <span class="nv">GLOB</span><span class="o">=</span><span class="m">1024</span>
                                                                                               <span class="nv">LOCK</span><span class="o">=</span><span class="m">40</span>
&lt;default&gt;                              MM       DYN    <span class="m">1024</span>                 <span class="m">100</span>       <span class="m">100</span>      DEFER
                                                                                               <span class="nv">LOCK</span><span class="o">=</span><span class="m">40</span>

                      *** Names ***

Global                         Region
---------------------------------------
*                            DEFAULT
Darjeeling                   TEAGLOBALS
LapsangSouchong              TEAGLOBALS
Tea*                         TEAGLOBALS

                           *** REGIONS  ***

Region                  Dynamic Segment         Def Coll   Rec Size   Key Size   Null Subs  Standard Null Coll   Journaling
-----------------------------------------------------------------------------------------------------------------------------
DEFAULT                   DEFAULT                 <span class="m">0</span>          <span class="m">256</span>         <span class="m">64</span>        NEVER             Y                N
TEAGLOBALS                TEAGLOBALS              <span class="m">0</span>          <span class="m">256</span>         <span class="m">64</span>        EXISTING          Y                N


                           *** SEGMENTS ***

Segment             File <span class="o">(</span>def ext: .dat<span class="o">)</span>     Acc  Typ   Block            Alloc   Exten     Options
-----------------------------------------------------------------------------------------------------
DEFAULT               yottadb.dat              BG   DYN   <span class="m">1024</span>              <span class="m">100</span>     <span class="m">100</span>      <span class="nv">GLOB</span><span class="o">=</span><span class="m">1024</span>
                                                                                           <span class="nv">LOCK</span><span class="o">=</span><span class="m">40</span>
                                                                                           <span class="nv">RES</span><span class="o">=</span><span class="m">0</span>
TEAGLOBALS            TEAGLOBALS.dat         BG   DYN   <span class="m">1024</span>              <span class="m">100</span>     <span class="m">100</span>      <span class="nv">GLOB</span><span class="o">=</span><span class="m">1024</span>
                                                                                           <span class="nv">LOCK</span><span class="o">=</span><span class="m">40</span>
                                                                                           <span class="nv">RES</span><span class="o">=</span><span class="m">0</span>

                              *** MAP ***

---------------------------------- Names --------------------------------------------------

From                          Upto                      Region/Segment/File <span class="o">(</span>def ext: .dat<span class="o">)</span>
---------------------------------------------------------------------------------------------
 %                          Darjeeling                     <span class="nv">REG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">SEG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">FILE</span><span class="o">=</span>yottadb.dat
Darjeeling                  Darjeeling0                    <span class="nv">REG</span><span class="o">=</span>TEAGLOBALS
                                                           <span class="nv">SEG</span><span class="o">=</span>TEAGLOBALS
                                                           <span class="nv">FILE</span><span class="o">=</span>TEAGLOBALS.dat
Darjeeling0                 LapsangSouchong                <span class="nv">REG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">SEG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">FILE</span><span class="o">=</span>yottadb.dat
LapsangSouchong             LapsangSouchong0               <span class="nv">REG</span><span class="o">=</span>TEAGLOBALS
                                                           <span class="nv">SEG</span><span class="o">=</span>TEAGLOBALS
                                                           <span class="nv">FILE</span><span class="o">=</span>TEAGLOBALS.dat
LapsangSouchong0            Tea                            <span class="nv">REG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">SEG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">FILE</span><span class="o">=</span>yottadb.dat
Tea                         Teb                            <span class="nv">REG</span><span class="o">=</span>TEAGLOBALS
                                                           <span class="nv">SEG</span><span class="o">=</span>TEAGLOBALS
                                                           <span class="nv">FILE</span><span class="o">=</span>TEAGLOBALS.dat
Teb                         ...                            <span class="nv">REG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">SEG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">FILE</span><span class="o">=</span>yottadb.dat
LOCAL LOCKS                                                <span class="nv">REG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">SEG</span><span class="o">=</span>DEFAULT
                                                           <span class="nv">FILE</span><span class="o">=</span>yottadb.dat
GDE&gt;
</pre></div>
</div>
</section>
<section id="dse">
<h4><a class="toc-backref" href="langfeat.html#id24">DSE</a><a class="headerlink" href="langfeat.html#dse" title="Permalink to this heading">¶</a></h4>
<p>The -null_subscripts qualifier accepts never, always and existing. The default qualifier is never.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The null subscript collation order cannot be changed using DSE.</p>
</div>
<p>dump –fileheader output reflects this for null_subscripts as well as null collation order.</p>
<p>For a region, “Standard Null Collation” in DSE dump output corresponds to -stdnullcoll field in .gld file. DSE displays TRUE for “Standard Null Collation” if the region has –STDNULLCOLL, otherwise it displays FALSE.</p>
<p>From the example above, the output of dump –fileheader for TEAGLOBALS.dat will be as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>DSE&gt; dump -fileheader

File            /tmp/yottadb.dat
Region          DEFAULT
Date/Time       <span class="m">19</span>-FEB-2018 <span class="m">18</span>:51:43 <span class="o">[</span><span class="nv">$H</span> <span class="o">=</span> <span class="m">60039</span>,67903<span class="o">]</span>
Access method                   BG        Global Buffers                <span class="m">1024</span>
Reserved Bytes                   <span class="m">0</span>        Block size <span class="o">(</span><span class="k">in</span> bytes<span class="o">)</span>         <span class="m">4096</span>
Maximum record size           <span class="m">4088</span>        Starting VBN                    <span class="m">49</span>
Maximum key size               <span class="m">255</span>        Total blocks            0x00000065
Null subscripts           EXISTING        Free blocks             0x00000049
Standard Null Collation      FALSE
Last Record Backup      0x00000001        Extension Count                <span class="m">100</span>
Last Database Bckup     0x00000001        Number of <span class="nb">local</span> maps             <span class="m">1</span>
Last Bytestream Bckup   0x00000001        Lock space              0x00000028
In critical section     0x00000000        Timers pending                   <span class="m">0</span>
Cache freeze id         0x00000000        Flush timer            <span class="m">00</span>:00:01:00
Freeze match            0x00000000        Flush trigger                  <span class="m">960</span>
Current transaction     0x000007CE        No. of writes/flush              <span class="m">7</span>
Create <span class="k">in</span> progress           FALSE        Modified cache blocks            <span class="m">0</span>
Reference count                  <span class="m">1</span>        Wait Disk                        <span class="m">0</span>
Journal State        <span class="o">[</span>inactive<span class="o">]</span> ON        Journal Before imaging        TRUE
Journal Allocation             <span class="m">100</span>        Journal Extension              <span class="m">100</span>
Journal Buffer Size           <span class="m">1000</span>        Journal Alignsize              <span class="m">128</span>
Journal AutoSwitchLimit    <span class="m">8388600</span>        Journal Epoch Interval         <span class="m">300</span>
Journal Yield Limit              <span class="m">8</span>        Journal Sync IO              FALSE
Journal File: /tmp/yottadb.mjl
Mutex Hard Spin Count          <span class="m">128</span>        Mutex Sleep Spin Count         <span class="m">128</span>
Mutex Spin Sleep Time         <span class="m">2048</span>        KILLs <span class="k">in</span> progress                <span class="m">0</span>
Replication State              OFF        Region Seqno    0x0000000000000001
Resync Seqno    0x0000000000000001        Resync transaction      0x00000001
</pre></div>
</div>
<p>With Standard null collation, the null subscript is represented by 0x01 instead of 0xFF with historical null collation. So, the output of dse dump -block for a null subscript will also be different.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>DSE&gt;dump -block<span class="o">=</span><span class="m">3</span>
   File /testarea1/null_subs/yottadb.dat
   Region DEFAULT

   Block     <span class="m">3</span>       Size    <span class="m">24</span>  Level   <span class="m">0</span>   TN  <span class="m">3</span>
   Rec:1  Blk <span class="m">3</span>  Off <span class="m">8</span>  Size A  Cmpc <span class="m">0</span>  Key ^a<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)</span>
            <span class="m">8</span> : <span class="p">|</span> <span class="m">0</span>  A  <span class="m">0</span>  <span class="m">0</span> <span class="m">61</span>  <span class="m">0</span>  <span class="m">1</span>  <span class="m">0</span>  <span class="m">0</span> <span class="m">31</span>              <span class="p">|</span>
                <span class="p">|</span>  .  .  .  .  a  .  .  .  . <span class="m">1</span>              <span class="p">|</span>
</pre></div>
</div>
<p>With historical null collation, for the same command output will be as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>DSE&gt;dump -block<span class="o">=</span><span class="m">3</span>
    File /testarea1/null_subs/yottadb.dat
    Region DEFAULT

           <span class="m">3</span>   Size <span class="m">24</span>   Level <span class="m">0</span>   TN <span class="m">3</span>
    Rec:1  Blk <span class="m">3</span>  Off <span class="m">8</span>  Size A  Cmpc <span class="m">0</span>  Key ^a<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)</span>
             <span class="m">8</span> : <span class="p">|</span>  <span class="m">0</span>  A  <span class="m">0</span>  <span class="m">0</span> <span class="m">61</span>  <span class="m">0</span>  FF  <span class="m">0</span>  <span class="m">0</span> <span class="m">31</span>             <span class="p">|</span>
                 <span class="p">|</span>  .  .  .  .  a  .  .  .  .   <span class="m">1</span>             <span class="p">|</span>
</pre></div>
</div>
</section>
<section id="m-commands-functions">
<h4><a class="toc-backref" href="langfeat.html#id25">M Commands/Functions</a><a class="headerlink" href="langfeat.html#m-commands-functions" title="Permalink to this heading">¶</a></h4>
<section id="zwrite">
<h5><a class="toc-backref" href="langfeat.html#id26">ZWRITE</a><a class="headerlink" href="langfeat.html#zwrite" title="Permalink to this heading">¶</a></h5>
<p>Since with standard collation, null subscripts collate before numeric and string subscripts, ZWR output will be different if nodes with null subscripts exist.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;ZWR
lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)=</span><span class="m">2</span>
lcl<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">3</span>
lcl<span class="o">(</span><span class="s2">&quot;x&quot;</span><span class="o">)=</span><span class="m">4</span>
</pre></div>
</div>
<p>With the same data and historical null collation, the output of ZWR will be as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lcl<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">3</span>
lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)=</span><span class="m">2</span>
lcl<span class="o">(</span><span class="s2">&quot;x&quot;</span><span class="o">)=</span><span class="m">4</span>
</pre></div>
</div>
</section>
<section id="order">
<h5><a class="toc-backref" href="langfeat.html#id27">$ORDER()</a><a class="headerlink" href="langfeat.html#order" title="Permalink to this heading">¶</a></h5>
<p>If the last subscript in the subscripted global or local variable name passed as a parameter to $ORDER() is null and a subscripted global or local variable with a null subscript exists, $ORDER() returns the next node at the specified level.</p>
<p>If the last subscript in the subscripted global or local variable name passed as a parameter to $ORDER() is null and a subscripted global or local variable with a null subscript does not exist, $ORDER() returns the first node at the specified level.</p>
<p>If the last subscript in the subscripted global or local variable name is null and second argument of $ORDER() is -1, $ORDER() will always return the last node at the specified level regardless of the existence of a subscripted global or local variable (with null subscript). This allows the user to traverse all the nodes in a specified level starting from the last.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;ZWRITE
lcl<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">3</span>
lcl<span class="o">(</span><span class="s2">&quot;x&quot;</span><span class="o">)=</span><span class="m">4</span>

YDB&gt;WRITE <span class="nv">$ORDER</span><span class="o">(</span>lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">))</span>
<span class="m">1</span>

YDB&gt;WRITE <span class="nv">$ORDER</span><span class="o">(</span>lcl<span class="o">(</span><span class="m">1</span><span class="o">))</span>
x

YDB&gt;WRITE <span class="nv">$ORDER</span><span class="o">(</span>lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)</span>,-1<span class="o">)</span>
x

YDB&gt;SET lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)=</span><span class="m">2</span>
YDB&gt;ZWRITE
lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)=</span><span class="m">2</span>
lcl<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">3</span>
lcl<span class="o">(</span><span class="s2">&quot;x&quot;</span><span class="o">)=</span><span class="m">4</span>

YDB&gt;WRITE <span class="nv">$ORDER</span><span class="o">(</span>lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">))</span>
<span class="m">1</span>

YDB&gt;WRITE <span class="nv">$ORDER</span><span class="o">(</span>lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)</span>,-1<span class="o">)</span>
x

YDB&gt;WRITE <span class="nv">$ORDER</span><span class="o">(</span>lcl<span class="o">(</span><span class="s2">&quot;x&quot;</span><span class="o">)</span>,-1<span class="o">)</span>
<span class="m">1</span>
</pre></div>
</div>
</section>
<section id="zprevious">
<h5><a class="toc-backref" href="langfeat.html#id28">$ZPREVIOUS()</a><a class="headerlink" href="langfeat.html#zprevious" title="Permalink to this heading">¶</a></h5>
<p>It is equivalent to $ORDER() with second argument -1.</p>
</section>
<section id="query">
<h5><a class="toc-backref" href="langfeat.html#id29">$QUERY()</a><a class="headerlink" href="langfeat.html#query" title="Permalink to this heading">¶</a></h5>
<p>With stdnullcoll, if $D(glvn(“”))=1 (or 11), $Q(glvn(“”)) will return glvn(1) [assuming glvn(1) exists]. Software should execute $D(glvn(“”)) to test the existence of glvn(“”). $Q(glvn(”…”)) will never return the starting-point (glvn(“”)) even though glvn(“”) may exist.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;ZWRITE lcl
lcl<span class="o">(</span><span class="s2">&quot;&quot;</span><span class="o">)=</span><span class="m">1</span>
lcl<span class="o">(</span><span class="m">1</span><span class="o">)=</span><span class="m">1</span>
lcl<span class="o">(</span><span class="m">1</span>,2<span class="o">)=</span><span class="m">2</span>
lcl<span class="o">(</span><span class="m">1</span>,2,<span class="s2">&quot;&quot;</span><span class="o">)=</span><span class="m">3</span>
lcl<span class="o">(</span><span class="m">1</span>,2,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span><span class="o">)=</span><span class="m">4</span>
lcl<span class="o">(</span><span class="m">1</span>,2,<span class="s2">&quot;&quot;</span>,<span class="s2">&quot;&quot;</span>,4<span class="o">)=</span><span class="m">5</span>
lcl<span class="o">(</span><span class="m">1</span>,2,0<span class="o">)=</span><span class="m">6</span>
lcl<span class="o">(</span><span class="m">1</span>,2,<span class="s2">&quot;abc&quot;</span>,5<span class="o">)=</span><span class="m">7</span>
lcl<span class="o">(</span><span class="s2">&quot;x&quot;</span><span class="o">)=</span><span class="m">1</span>

YDB&gt;SET <span class="nv">y</span><span class="o">=</span><span class="s2">&quot;x”</span>

<span class="s2">YDB&gt;FOR SET y=</span><span class="nv">$QUERY</span><span class="s2">(@y) QUIT:y=&quot;&quot; WRITE !,y,&quot;</span><span class="o">=</span><span class="s2">&quot;,@y</span>
</pre></div>
</div>
<p>The output will be the same as the ZWRITE output.</p>
<p>For more details about the behavior of these functions with historical null collation, please consult the <a class="reference external" href="index.html">M Programmer’s Guide</a>.</p>
</section>
</section>
<section id="mupip-binary-extract-and-load">
<h4><a class="toc-backref" href="langfeat.html#id30">MUPIP Binary Extract and Load</a><a class="headerlink" href="langfeat.html#mupip-binary-extract-and-load" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>MUPIP EXTRACT BINARY issues NULLCOLLDIFF error if it needs to extract from multiple databases with different STDNULCOLL settings.</p></li>
<li><p>MUPIP EXTRACT BINARY writes a new field in the binary extract header to note down the first database’s STDNULCOLL setting.</p></li>
<li><p>MUPIP LOAD BINARY on a binary extract transforms the null subscripts appropriately if the STDNULCOLL setting of the target database is different from the setting in the binary extract header.</p></li>
<li><p>MUPIP LOAD BINARY is able to successfully load onto multiple databases with different STDNULCOLL settings.</p></li>
<li><p>MUPIP EXTRACT ZWR and MUPIP LOAD ZWR will work no matter what the YottaDB version of the source and destination databases, and no matter what the null (or other) collation setting of the source and destination databases.</p></li>
</ul>
</section>
<section id="replication">
<h4><a class="toc-backref" href="langfeat.html#id31">Replication</a><a class="headerlink" href="langfeat.html#replication" title="Permalink to this heading">¶</a></h4>
<p>In a replicated environment, all databases belonging to an instance should have the same null collation order. If this condition is not met, the source server issues the YDB-E-NULLCOLLDIFF error message on the primary. On the secondary, the update process issues the same error message if the condition is not satisfied.</p>
<p>Although all databases belonging to an instance must have the same collation method, YottaDB allows the primary and secondary to use different null collation methods. Any needed conversion is handled internally and transparently.</p>
</section>
</section>
<section id="local-variables">
<h3><a class="toc-backref" href="langfeat.html#id32">Local Variables</a><a class="headerlink" href="langfeat.html#local-variables" title="Permalink to this heading">¶</a></h3>
<p>A local variable in M refers to a variable used solely within the scope of a single process. Local variable names have no leading delimiter.</p>
<p>M makes a local variable available and subject to modification by all routines executed within a process from the time that variable is first SET until it is KILLed, or until the process stops executing M. However, M “protects” a local variable after that variable appears as an argument to a NEW command, or after it appears as an element in a formallist used in parameter passing. When M protects a local variable, it saves a copy of the variable’s value and makes that variable undefined. M restores the variable to its saved value during execution of the QUIT that terminates the process stack level associated with the “protecting” NEW or formallist. For more information on NEW and QUIT, see <a class="reference external" href="commands.html">Chapter 6: “Commands”</a>.</p>
<p>M restricts the following uses of variables to local variables:</p>
<ul class="simple">
<li><p>FOR command control variables.</p></li>
<li><p>Elements within the parentheses of an “exclusive” KILL.</p></li>
<li><p>TSTART [with local variables list].</p></li>
<li><p>A KILL with no arguments removes all current local variables.</p></li>
<li><p>NEW command arguments.</p></li>
<li><p>Actualnames used by pass-by-reference parameter passing.</p></li>
</ul>
</section>
<section id="global-variables-and-resource-name-environments">
<h3><a class="toc-backref" href="langfeat.html#id33">Global Variables and Resource Name Environments</a><a class="headerlink" href="langfeat.html#global-variables-and-resource-name-environments" title="Permalink to this heading">¶</a></h3>
<p>M recognizes an optional environment specification in global names or in the LOCK resource names (nrefs), which have analogous syntax. Global variable names have a leading caret symbol (^) as a delimiter.</p>
<p>M makes a global variable available, and subject to modification by all routines executed within all processes in an environment, from the time that variable is first SET until it is KILLed.</p>
</section>
<section id="naked-references">
<h3><a class="toc-backref" href="langfeat.html#id34">Naked References</a><a class="headerlink" href="langfeat.html#naked-references" title="Permalink to this heading">¶</a></h3>
<p>M accepts an abbreviation of the global name under some circumstances. When the leading caret symbol (^) immediately precedes the left parenthesis delimiting subscripts, the global variable reference is called a naked reference. M evaluates a naked reference by prefixing the last used global variable name, except for its last subscript, to the list of subscripts specified by the naked reference. The prefixed portion is known as the naked indicator. An attempt to use a naked reference when the prior global reference does not exist, or did not contain a subscript, generates an error.</p>
<p>Because M has only one process-wide naked indicator which it maintains as a side affect of every evaluation of a global variable, using the naked reference requires an understanding of M execution sequence. M execution generally proceeds from left to right within a line, subject to commands that change the flow of control. However, M evaluates the portion of a SET command argument to the right side of the equal sign before the left side. Also, M does not evaluate any further $SELECT() arguments within the function after it encounters a true selection argument.</p>
<p>In general, using naked references only in very limited circumstances prevents problems associated with the naked indicator.</p>
</section>
<section id="global-variable-name-environments">
<h3><a class="toc-backref" href="langfeat.html#id35">Global Variable Name Environments</a><a class="headerlink" href="langfeat.html#global-variable-name-environments" title="Permalink to this heading">¶</a></h3>
<p>M recognizes an optional environment specification in global names. The environment specification designates one of some set of alternative database files.</p>
<p>The syntax for global variable names that include an environment specification is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>^|expr|name[(subscript[,...])]
</pre></div>
</div>
<p>In YottaDB, the expression identifies the Global Directory for mapping the global variable.</p>
<p>Environment specifications permit easy access to global variables in alternative databases, including other “copies” of active variables in the current database. Environment specifications are sometimes referred to as extended global syntax or extended value syntax.</p>
<p>YottaDB also allows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>^|expr1,expr2|name[(subscript[,...])]
</pre></div>
</div>
<p>Where the first expression identifies the Global Directory and the second expression is accepted but ignored by YottaDB.</p>
<p>To improve compatibility with some other M implementations, YottaDB also accepts another non-standard syntax. In this syntax, the leading and trailing up-bar (|) are respectively replaced by a left square-bracket ([) and a right square-bracket (]). This syntax also requires expratoms, rather than expressions. For additional information on expratoms, see <a class="reference internal" href="langfeat.html#expressions"><span class="std std-ref">Expressions</span></a>.</p>
<p>The formats for this non-standard syntax are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>^[expratom1]name[(subscript...)]
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>^[expratom1,expratom2]name[(subscript...)]
</pre></div>
</div>
<p>Where expratom1 identifies the Global Directory and expratom2 is a dummy variable. Note that the first set of brackets in each format is part of the syntax. The second set of square brackets is part of the meta-language identifying an optional element.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nv">ydb_gbldir</span><span class="o">=</span>Test.GLD
$ <span class="nb">export</span> ydb_gbldir
$ YDB

YDB&gt;WRITE <span class="nv">$ZGBLDIR</span>
TEST.GLD
YDB&gt;WRITE ^A
THIS IS ^A IN DATABASE RED
YDB&gt;WRITE ^<span class="p">|</span><span class="s2">&quot;M1.GLD&quot;</span><span class="p">|</span>A
THIS IS ^A IN DATABASE WHITE
YDB&gt;WRITE <span class="nv">$ZGBLDIR</span>
TEST.GLD
YDB&gt;HALT

$ <span class="nb">echo</span> ydb_gbldir
TEST.GLD
</pre></div>
</div>
<p>The statement WRITE ^|”M1.GLD”|A writes variable ^A using the Global Directory, M1.GLD, but does not change the current Global Directory.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="nv">$ZGBLDIR</span>
M1.GLD
YDB&gt;WRITE ^A
THIS IS ^A IN DATABASE WHITE
YDB&gt;WRITE ^<span class="p">|</span><span class="s2">&quot;M1.GLD&quot;</span><span class="p">|</span>A
THIS IS ^A IN DATABASE WHITE
</pre></div>
</div>
<p>The statement WRITE ^|”M1.GLD”|A is equivalent to WRITE ^A.</p>
<p>Specifying separate Global Directories does not always translate to using separate databases.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE ^<span class="p">|</span><span class="s2">&quot;M1.GLD&quot;</span><span class="p">|</span>A,!,^<span class="p">|</span><span class="s2">&quot;M2.GLD&quot;</span><span class="p">|</span>A,!,^<span class="p">|</span><span class="s2">&quot;M3.GLD&quot;</span>
<span class="p">|</span>A,!
THIS IS ^A IN DATABASE WHITE
THIS IS ^A IN DATABASE BLUE
THIS IS ^A IN DATABASE WHITE
</pre></div>
</div>
<p>In this example, the WRITE does not display ^A from three YottaDB database files. Mapping specified by the Global Directory Editor (GDE) determines the database file to which a Global Directory points.</p>
<p>This result could have occurred under the following mapping:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>^<span class="p">|</span><span class="s2">&quot;M1.GLD&quot;</span><span class="p">|</span>A --&gt; REGIONA --&gt; SEGMENTA --&gt; FILE1.DAT
^<span class="p">|</span><span class="s2">&quot;M2.GLD&quot;</span><span class="p">|</span>A --&gt; REGIONA --&gt; SEGMENT1 --&gt; FILE2.DAT
^<span class="p">|</span><span class="s2">&quot;M3.GLD&quot;</span><span class="p">|</span>A --&gt; REGION3 --&gt; SEGMENT3 --&gt; FILE1.DAT
</pre></div>
</div>
<p>For more information on Global Directories, refer to the <a class="reference external" href="../AdminOpsGuide/gde.html">“Global Directory Editor”</a> chapter of the Administration and Operations Guide.</p>
<section id="optional-yottadb-environment-translation-facility">
<span id="opt-ydb-env-xltn-fac"></span><h4><a class="toc-backref" href="langfeat.html#id36">Optional YottaDB Environment Translation Facility</a><a class="headerlink" href="langfeat.html#optional-yottadb-environment-translation-facility" title="Permalink to this heading">¶</a></h4>
<p>To facilitate application migration to YottaDB from other M implementations (for example to convert UCI and VOL specifications to global directories) in the environment specification, YottaDB provides an interface to translate strings to global directory filenames.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using this facility impacts the performance of every global access that uses environment specification. Make sure you use it only when static determination of the global directory is not feasible. When used, maximize the efficiency of the translation routines.</p>
</div>
<p>The use of this facility is enabled by the definition of the environment variable ydb_env_translate, which contains the path of a shared library with the following entry point:</p>
<section id="ydb-env-xlate">
<h5><a class="toc-backref" href="langfeat.html#id37">ydb_env_xlate</a><a class="headerlink" href="langfeat.html#ydb-env-xlate" title="Permalink to this heading">¶</a></h5>
<p>If the shared object is not accessible or the entry point is not accessible, YottaDB reports an error.</p>
<p>The ydb_env_xlate() routine has the following C prototype:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">ydb_env_xlate</span><span class="p">(</span><span class="n">ydb_string_t</span><span class="w"> </span><span class="o">*</span><span class="n">in1</span><span class="p">,</span><span class="w"> </span><span class="n">ydb_st</span><span class="w"></span>
<span class="w">   </span><span class="n">ring_t</span><span class="w"> </span><span class="o">*</span><span class="n">in2</span><span class="p">,</span><span class="w"> </span><span class="n">ydb_string</span><span class="w"> </span><span class="o">*</span><span class="n">in3</span><span class="p">,</span><span class="w"> </span><span class="n">ydb_string_t</span><span class="w"> </span><span class="o">*</span><span class="n">out</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>where ydb_string_t is a structure defined in libyottadb.h as follows:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w">   </span><span class="n">length</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="kt">char</span><span class="w">            </span><span class="o">*</span><span class="n">address</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">ydb_string_t</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The purpose of the function is to use its three input arguments to derive and return an output argument that can be used as an environment specification by YottaDB. Note that the input values passed (in1, in2 and in3) are the result of M evaluation and must not be modified. The first two arguments are the expressions passed within the up-bars “| |” or the square-brackets “[ ]”, and the third argument is the current working directory as described by $ZDIRECTORY.</p>
<p>A return value other than zero (0) indicates an error in translation, and is reported by a YottaDB error.</p>
<p>If the length of the output argument is non-zero, YottaDB appends a secondary message of YDB-I-TEXT, containing the text found at the address of the output structure.</p>
<p>YottaDB does not do any memory management related to the output argument - space for the output should be allocated by the external routine. The routine must place the returned environment specification at the address it has allocated and adjust the length accordingly. On a successful return, the return value should be zero. If the translation routine must communicate an error to YottaDB, it must return a non-zero value, and if it is to communicate additional error information, place the error text at the address where the environment would normally go and adjust the length to match the length of the error text.</p>
<p>Length of the return value may range from 0-32767, otherwise YottaDB reports an error.</p>
<p>A zero-length (empty) string specifies the current value of $ZGBLDIR. Non-zero lengths must represent the actual length of the file specification pointed to by the address, excluding any &lt;NUL&gt; terminator. If the address field of the output argument is NULL, YottaDB issues an error.</p>
<p>The file specification may be absolute or relative and may contain an environment variable. If the file specified is not accessible, or is not a valid global directory, YottaDB reports errors in the same way it does for any invalid global directory.</p>
<p>It is possible to write this routine in M (as a call-in), however, global variables in such a routine would change the naked indicator, which environment references normally do not. Depending on the conventions of the application, there might be difficult name-space management issues such as protecting the local variables used by the M routine.</p>
<p>While it is possible for this routine to take any form that the application designer finds appropriate within the given interface definition, the following paragraphs make some recommendations based on the expectation that a routine invoked for any more than a handful of global references should be efficient.</p>
<p>It is expected that the routine loads one or more tables, either at compilation or the first time it is invoked. The logic of the routine performs a look up on the entry in the set of tables. The lookup might be based on the length of the strings and some unique set of characters in the names, or a hash, with collision provisions as appropriate.</p>
<p>The routine may have to deal with a case where one or both of the inputs have zero length. A subset of these cases may have the first string holding a comma limited string that needs to be re-interpreted as being equivalent to two input strings (note that the input strings must never be modified). The routine may also have to handle cases where a value (most likely the first) is accidentally or intentionally, already a global directory specification.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cat ydb_env_xlate.c
<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;string.h&gt;</span>
<span class="c1">#include &quot;libyottadb.h&quot;</span>
static int <span class="nv">init</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>
typedef struct
<span class="o">{</span>
  ydb_string_t field1, field2, ret<span class="p">;</span>
<span class="o">}</span> line_entry <span class="p">;</span>
static line_entry table<span class="o">[</span><span class="m">5</span><span class="o">]</span>, *line, linetmp<span class="p">;</span>
/* Since these errors may occur before setup is complete, they are statics */
static char *errorstring1 <span class="o">=</span><span class="s2">&quot;Error in function initialization, environment variable GTM_CALLIN_START not defined. Environment translation failed.&quot;</span><span class="p">;</span>
static char *errorstring2 <span class="o">=</span><span class="s2">&quot;Error in function initialization, function pointers could not be determined. Environment translation failed.&quot;</span><span class="p">;</span>
<span class="c1">#define ENV_VAR&quot;GTM_CALLIN_START&quot;</span>
typedef int<span class="o">(</span>*int_fptr<span class="o">)()</span><span class="p">;</span>
int_fptr GTM_MALLOC<span class="p">;</span>
int init_functable<span class="o">(</span>ydb_string_t *ptr<span class="o">)</span>
<span class="o">{</span>
/* This <span class="k">function</span> demonstrates the initialization of other <span class="k">function</span> pointers as well <span class="o">(</span><span class="k">if</span> the user-code needs them <span class="k">for</span> any reason, they should be defined as globals<span class="o">)</span> */
char *pcAddress<span class="p">;</span>
long lAddress<span class="p">;</span>
void **functable<span class="p">;</span>
void <span class="o">(</span>*setup_timer<span class="o">)</span> <span class="o">()</span><span class="p">;</span>
void <span class="o">(</span>*cancel_timer<span class="o">)</span> <span class="o">()</span><span class="p">;</span>
<span class="nv">pcAddress</span> <span class="o">=</span> getenv<span class="o">(</span>ENV_VAR<span class="o">)</span><span class="p">;</span>
<span class="k">if</span> <span class="o">(</span><span class="nv">pcAddress</span> <span class="o">==</span> NULL<span class="o">)</span>
<span class="o">{</span>
ptr-&gt;length <span class="o">=</span> strlen<span class="o">(</span>errorstring1<span class="o">)</span><span class="p">;</span>
ptr-&gt;address <span class="o">=</span> errorstring1<span class="p">;</span>
<span class="k">return</span> <span class="m">1</span><span class="p">;</span>
<span class="o">}</span>
<span class="nv">lAddress</span> <span class="o">=</span> -1<span class="p">;</span>
<span class="nv">lAddress</span> <span class="o">=</span> atol<span class="o">(</span>pcAddress<span class="o">)</span><span class="p">;</span>
<span class="k">if</span> <span class="o">(</span><span class="nv">lAddress</span> <span class="o">==</span> -1<span class="o">)</span>
<span class="o">{</span>
ptr-&gt;length <span class="o">=</span> strlen<span class="o">(</span>errorstring2<span class="o">)</span><span class="p">;</span>
ptr-&gt;address <span class="o">=</span> errorstring2<span class="p">;</span>
<span class="k">return</span> <span class="m">1</span><span class="p">;</span>
<span class="o">}</span>
<span class="nv">functable</span> <span class="o">=</span> <span class="o">(</span>void *<span class="o">)</span>lAddress<span class="p">;</span>
<span class="nv">setup_timer</span> <span class="o">=</span> <span class="o">(</span>void<span class="o">(</span>*<span class="o">)())</span> functable<span class="o">[</span><span class="m">2</span><span class="o">]</span><span class="p">;</span>
<span class="nv">cancel_timer</span> <span class="o">=</span> <span class="o">(</span>void<span class="o">(</span>*<span class="o">)())</span> functable<span class="o">[</span><span class="m">3</span><span class="o">]</span><span class="p">;</span>
<span class="nv">GTM_MALLOC</span> <span class="o">=</span> <span class="o">(</span>int_fptr<span class="o">)</span> functable<span class="o">[</span><span class="m">4</span><span class="o">]</span><span class="p">;</span>
<span class="k">return</span> <span class="m">0</span><span class="p">;</span>
<span class="o">}</span>
void copy_string<span class="o">(</span>char **loc1, char *loc2, int length<span class="o">)</span>
<span class="o">{</span>
char *ptr<span class="p">;</span>
<span class="nv">ptr</span> <span class="o">=</span> <span class="o">(</span>char *<span class="o">)</span> ydb_malloc<span class="o">(</span>length<span class="o">)</span><span class="p">;</span>
strncpy<span class="o">(</span> ptr, loc2, length<span class="o">)</span><span class="p">;</span>
*loc1 <span class="o">=</span> ptr<span class="p">;</span>
<span class="o">}</span>
int init_table<span class="o">(</span>ydb_string_t *ptr<span class="o">)</span>
<span class="o">{</span>
int <span class="nv">i</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>
char buf<span class="o">[</span><span class="m">100</span><span class="o">]</span><span class="p">;</span>
char *buf1, *buf2<span class="p">;</span>
FILE *tablefile<span class="p">;</span>
char *space <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">;</span>
char *errorstr1 <span class="o">=</span> <span class="s2">&quot;Error opening table file table.dat&quot;</span><span class="p">;</span>
char *errorstr2 <span class="o">=</span> <span class="s2">&quot;UNDETERMINED ERROR FROM GTM_ENV_XLATE&quot;</span><span class="p">;</span>
<span class="k">if</span> <span class="o">((</span><span class="nv">tablefile</span> <span class="o">=</span> fopen<span class="o">(</span><span class="s2">&quot;table.dat&quot;</span>,<span class="s2">&quot;r&quot;</span><span class="o">))</span> <span class="o">==</span> <span class="o">(</span>FILE *<span class="o">)</span>NULL<span class="o">)</span>
<span class="o">{</span>
ptr-&gt;length <span class="o">=</span> strlen<span class="o">(</span>errorstr1<span class="o">)</span><span class="p">;</span>
copy_string<span class="o">(</span><span class="p">&amp;</span><span class="o">(</span>ptr-&gt;address<span class="o">)</span>, errorstr1, strlen<span class="o">(</span>errorstr1<span class="o">))</span><span class="p">;</span>
<span class="k">return</span> <span class="m">1</span><span class="p">;</span>
<span class="o">}</span>
<span class="k">while</span> <span class="o">(</span>fgets<span class="o">(</span>buf, <span class="o">(</span>int<span class="o">)</span>sizeof<span class="o">(</span>buf<span class="o">)</span>, tablefile<span class="o">)</span> !<span class="o">=</span> <span class="o">(</span>char *<span class="o">)</span>NULL<span class="o">)</span>
<span class="o">{</span>
<span class="nv">line</span><span class="o">=</span> <span class="p">&amp;</span>table<span class="o">[</span>i++<span class="o">]</span><span class="p">;</span>
<span class="nv">buf1</span> <span class="o">=</span> buf<span class="p">;</span>
<span class="nv">buf2</span> <span class="o">=</span>strstr<span class="o">(</span>buf1, space<span class="o">)</span><span class="p">;</span>
line-&gt;field1.length <span class="o">=</span> buf2 - buf1<span class="p">;</span>
copy_string<span class="o">(</span> <span class="p">&amp;</span><span class="o">(</span>line-&gt;field1.address<span class="o">)</span>, buf1, line-&gt;field1.length<span class="o">)</span><span class="p">;</span>
<span class="nv">buf1</span> <span class="o">=</span> buf2+1<span class="p">;</span>
<span class="nv">buf2</span> <span class="o">=</span> strstr<span class="o">(</span>buf1, space<span class="o">)</span><span class="p">;</span>
line-&gt;field2.length <span class="o">=</span> buf2-buf1<span class="p">;</span>
copy_string<span class="o">(</span> <span class="p">&amp;</span><span class="o">(</span>line-&gt;field2.address<span class="o">)</span>, buf1, line-&gt;field2.length<span class="o">)</span><span class="p">;</span>
<span class="nv">buf1</span> <span class="o">=</span> buf2+1<span class="p">;</span>
line-&gt;ret.length <span class="o">=</span> strlen<span class="o">(</span>buf1<span class="o">)</span> - <span class="m">1</span><span class="p">;</span>
copy_string<span class="o">(</span> <span class="p">&amp;</span><span class="o">(</span>line-&gt;ret.address<span class="o">)</span>, buf1, line-&gt;ret.length<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
fclose<span class="o">(</span>tablefile<span class="o">)</span><span class="p">;</span>
/* In this example, the last entry <span class="k">in</span> the table is the error string */
<span class="nv">line</span> <span class="o">=</span> <span class="p">&amp;</span>table<span class="o">[</span><span class="m">4</span><span class="o">]</span><span class="p">;</span>
copy_string<span class="o">(</span> <span class="p">&amp;</span><span class="o">(</span>line-&gt;ret.address<span class="o">)</span>, errorstr2, strlen<span class="o">(</span>errorstr2<span class="o">))</span><span class="p">;</span>
line-&gt;ret.length <span class="o">=</span> strlen<span class="o">(</span>errorstr2<span class="o">)</span><span class="p">;</span>
<span class="k">return</span> <span class="m">0</span><span class="p">;</span>
<span class="o">}</span>
int cmp_string<span class="o">(</span>ydb_string_t str1, ydb_string_t str2<span class="o">)</span>
<span class="o">{</span>
<span class="k">if</span> <span class="o">(</span>str1.length <span class="o">==</span> str2.length<span class="o">)</span>
<span class="k">return</span> strncmp<span class="o">(</span>str1.address, str2.address, <span class="o">(</span>int<span class="o">)</span> str1.length<span class="o">)</span><span class="p">;</span>
<span class="k">else</span>
<span class="k">return</span> str1.length - str2.length<span class="p">;</span>
<span class="o">}</span>
int cmp_line<span class="o">(</span>line_entry *line1, line_entry *line2<span class="o">)</span>
<span class="o">{</span>
<span class="k">return</span> <span class="o">(((</span>cmp_string<span class="o">(</span>line1-&gt;field1, line2-&gt;field1<span class="o">))||(</span>cmp_string<span class="o">(</span>line1-&gt;field2, line2-&gt;field2<span class="o">))))</span><span class="p">;</span>
<span class="o">}</span>
int look_up_table<span class="o">(</span>line_entry *aline, ydb_string_t *ret_ptr<span class="o">)</span>
<span class="o">{</span>
int i<span class="p">;</span>
int ret_v<span class="p">;</span>
<span class="k">for</span><span class="o">(</span><span class="nv">i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span>i&lt;<span class="m">4</span><span class="p">;</span>i++<span class="o">)</span>
<span class="o">{</span>
<span class="nv">line</span> <span class="o">=</span> <span class="p">&amp;</span>table<span class="o">[</span>i<span class="o">]</span><span class="p">;</span>
<span class="nv">ret_v</span> <span class="o">=</span> cmp_line<span class="o">(</span> aline, line<span class="o">)</span><span class="p">;</span>
<span class="k">if</span> <span class="o">(</span>!ret_v<span class="o">)</span>
<span class="o">{</span>
ret_ptr-&gt;length <span class="o">=</span> line-&gt;ret.length<span class="p">;</span>
ret_ptr-&gt;address <span class="o">=</span> line-&gt;ret.address<span class="p">;</span>
<span class="k">return</span> <span class="m">0</span><span class="p">;</span>
<span class="o">}</span>
<span class="o">}</span>
/*ERROR OUT*/
<span class="nv">line</span> <span class="o">=</span> <span class="p">&amp;</span>table<span class="o">[</span><span class="m">4</span><span class="o">]</span><span class="p">;</span>
ret_ptr-&gt;length<span class="o">=</span> line-&gt;ret.length<span class="p">;</span>
ret_ptr-&gt;address <span class="o">=</span> line-&gt;ret.address<span class="p">;</span>
<span class="k">return</span> <span class="m">1</span><span class="p">;</span>
<span class="o">}</span>
int ydb_env_xlate<span class="o">(</span>ydb_string_t *ptr1, ydb_string_t *ptr2, ydb_string_t *ptr_zdir, ydb_string_t *ret_ptr<span class="o">)</span>
<span class="o">{</span>
int return_val, return_val_init<span class="p">;</span>
<span class="k">if</span> <span class="o">(</span>!init<span class="o">)</span>
<span class="o">{</span>
<span class="nv">return_val_init</span> <span class="o">=</span> init_functable<span class="o">(</span>ret_ptr<span class="o">)</span><span class="p">;</span>
<span class="k">if</span> <span class="o">(</span>return_val_init<span class="o">)</span> <span class="k">return</span> return_val_init<span class="p">;</span>
<span class="nv">return_val_init</span> <span class="o">=</span> init_table<span class="o">(</span>ret_ptr<span class="o">)</span><span class="p">;</span>
<span class="k">if</span> <span class="o">(</span>return_val_init<span class="o">)</span> <span class="k">return</span> return_val_init<span class="p">;</span>
<span class="nv">init</span> <span class="o">=</span> <span class="m">1</span><span class="p">;</span>
<span class="o">}</span>
linetmp.field1.length<span class="o">=</span> ptr1-&gt;length<span class="p">;</span>
linetmp.field1.address<span class="o">=</span> ptr1-&gt;address<span class="p">;</span>
linetmp.field2.length<span class="o">=</span> ptr2-&gt;length<span class="p">;</span>
linetmp.field2.address<span class="o">=</span> ptr2-&gt;address<span class="p">;</span>
<span class="nv">return_val</span> <span class="o">=</span> look_up_table<span class="o">(</span><span class="p">&amp;</span>linetmp, ret_ptr<span class="o">)</span><span class="p">;</span>
<span class="k">return</span> return_val<span class="p">;</span>
<span class="o">}</span>
&gt; cat table.dat
day1 week1 yottadb
day2 week1 a
day3 week2 b
day4 week2 c.gld
</pre></div>
</div>
<p>This example demonstrates the mechanism. A table is set up the first time for proper memory management, and for each reference, a table lookup is performed. Note that for the purpose of simplicity, no error checking is done, so table.dat is assumed to be in the correct format, and have exactly four entries. This routine should be built as a shared library, see <a class="reference external" href="extrout.html">Chapter 11: “Integrating External Routines”</a> for information on building as a shared library. The function init_functable is necessary to set up the YottaDB memory management functions.</p>
</section>
</section>
</section>
</section>
<section id="literals">
<h2><a class="toc-backref" href="langfeat.html#id38">Literals</a><a class="headerlink" href="langfeat.html#literals" title="Permalink to this heading">¶</a></h2>
<p>M has both string and numeric literals.</p>
<section id="string-literals">
<h3><a class="toc-backref" href="langfeat.html#id39">String Literals</a><a class="headerlink" href="langfeat.html#string-literals" title="Permalink to this heading">¶</a></h3>
<p>A string literal (strlit) is enclosed in quotation marks (” “) and can contain a sequence of ASCII and Unicode® UTF-8 characters. While the standard indicates the characters must be graphic, YottaDB accepts non-graphic characters and, at compile-time, gives a warning. Using $CHAR() and concatenate to represent non-graphic characters in strings not only avoids the warning but is less error prone and makes for easier understanding. M attempts to use character text that appears outside of quotation mark delimiters according to context, which generally means as a local variable name.</p>
<p>To include a quotation mark (”) within a strlit, use a set of two quotation marks (”” “”).</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;write <span class="s2">&quot;&quot;&quot;&quot;</span>
<span class="s2">&quot;</span>
<span class="s2">YDB&gt;</span>
</pre></div>
</div>
<p>The WRITE displays a single quotation mark because the first quotation mark delimits the beginning of the string literal, the next two quotation marks denote a single quote within the string, and the last quotation mark delimits the end of the string literal.</p>
<p>Use the $CHAR function and the concatenation operator to include control characters within a string.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="s2">&quot;A&quot;</span>_<span class="nv">$CHAR</span><span class="o">(</span><span class="m">9</span><span class="o">)</span>_<span class="s2">&quot;B&quot;</span>
A B
YDB&gt;
</pre></div>
</div>
<p>The WRITE displays an “A,” followed by a tab (&lt;HT&gt;), followed by a “B” using $CHAR(), to introduce the non-graphic character.</p>
</section>
<section id="numeric-literals">
<h3><a class="toc-backref" href="langfeat.html#id40">Numeric Literals</a><a class="headerlink" href="langfeat.html#numeric-literals" title="Permalink to this heading">¶</a></h3>
<p>In M, numeric literals (numlit) are entered without surrounding delimiters.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="m">1</span>
<span class="m">1</span>
YDB&gt; WRITE <span class="m">1</span>.1
<span class="m">1</span>.1
</pre></div>
</div>
<p>These display numeric literals that are integer and decimal.</p>
<p>M also accepts numeric literals in the form of a mantissa and an exponent, separated by a delimiter of “E” in uppercase. The mantissa may be an integer or a decimal fraction. The integer exponent may have an optional leading minus sign (-).</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE 8E6
<span class="m">8000000</span>
YDB&gt; WRITE 8E-6
.000008
YDB&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The exponential numeric form may lead to ambiguities in the meaning of subscripts. Because numeric subscripts collate ahead of string subscripts, the string subscript “01E5” is not the same as the numeric subscript 01E5.</p>
</div>
<p>YottaDB handles numeric strings which are not canonical within the implementation as strings unless the application specifically requests they be treated as numbers. Any use in a context defined as numeric elicits numeric treatment; this includes operands of numeric operators, numeric literals, and some intrinsic function arguments. When the code creates a large number out of range, YottaDB gives a NUMOFLOW error. When the code creates a small fractional number out of range YottaDB treats it as zero (0). The YottaDB number range is (to the limit of accuracy) 1E-43 to 1E47. When the application creates an in-range number that exceeds the YottaDB numeric accuracy of 18 significant digits, YottaDB silently retains the most significant digits. With standard collation, YottaDB collates canonic numeric strings used as subscripts numerically, while it collates non-canonic numbers as strings.</p>
</section>
</section>
<section id="expressions">
<span id="id1"></span><h2><a class="toc-backref" href="langfeat.html#id41">Expressions</a><a class="headerlink" href="langfeat.html#expressions" title="Permalink to this heading">¶</a></h2>
<p>The following items are legal M expression atoms (expratoms). An expression atom is a component of an M expression.</p>
<ul class="simple">
<li><p>Local variables</p></li>
<li><p>Global variables</p></li>
<li><p>Intrinsic special variables</p></li>
<li><p>Intrinsic functions</p></li>
<li><p>Extrinsic functions</p></li>
<li><p>Extrinsic special variables</p></li>
<li><p>Numeric literals</p></li>
<li><p>String literals</p></li>
<li><p>An expression enclosed in parentheses</p></li>
<li><p>Any of the above preceded by a unary operator</p></li>
</ul>
<p>In addition, any of these items may be combined with a binary operator and another expression atom.</p>
</section>
<section id="operators">
<h2><a class="toc-backref" href="langfeat.html#id42">Operators</a><a class="headerlink" href="langfeat.html#operators" title="Permalink to this heading">¶</a></h2>
<p>M has both unary and binary operators.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="code docutils literal notranslate"><span class="pre">.</span></code> is not an operator. Please refer to the <a class="reference internal" href="langfeat.html#parameter-passing"><span class="std std-ref">Parameter Passing</span></a> sub-section for more information on usage of <code class="code docutils literal notranslate"><span class="pre">.</span></code></p>
</div>
<section id="precedence">
<h3><a class="toc-backref" href="langfeat.html#id43">Precedence</a><a class="headerlink" href="langfeat.html#precedence" title="Permalink to this heading">¶</a></h3>
<p>All unary operations have right to left precedence.</p>
<p>All M binary operations have strict left to right precedence. This includes all arithmetic, string, and logical operations. Hierarchies of operations require explicit establishment of precedence using parentheses (). Although this rule is counterintuitive, it is easy to remember and has no exceptions.</p>
</section>
<section id="arithmetic-operators">
<span id="arithmetic-ops"></span><h3><a class="toc-backref" href="langfeat.html#id44">Arithmetic Operators</a><a class="headerlink" href="langfeat.html#arithmetic-operators" title="Permalink to this heading">¶</a></h3>
<p>All arithmetic operators force M to evaluate the expressions to which they apply as numeric.</p>
<p>The arithmetic operators are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+</p></td>
<td><p>as a unary operator it simply forces M to evaluate the expression following as numeric; as a binary operator it causes M to perform addition</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>as a unary operator it causes M to negate the expression following; as a binary operator it causes M to perform subtraction</p></td>
</tr>
<tr class="row-even"><td><p>*</p></td>
<td><p>binary operator for multiplication</p></td>
</tr>
<tr class="row-odd"><td><p>**</p></td>
<td><p>binary operator for exponentiation</p></td>
</tr>
<tr class="row-even"><td><p>/</p></td>
<td><p>binary operator for fractional division</p></td>
</tr>
<tr class="row-odd"><td><p>\</p></td>
<td><p>binary operator for integer division</p></td>
</tr>
<tr class="row-even"><td><p>#</p></td>
<td><p>binary operator for modulo, that is, causes M to produce the remainder from integer division of the first argument by the second</p></td>
</tr>
</tbody>
</table>
<p>Because of the practice of using it to intentionally induce an error, YottaDB does not produce a DIVZERO error at compile time, only at run time, for divide or integer divide by a literal expression that evaluates to zero (0).</p>
<p>Remember that precedence is left to right for all arithmetic operators.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="m">1</span>+1
<span class="m">2</span>
YDB&gt;WRITE <span class="m">2</span>-1
<span class="m">1</span>
YDB&gt;WRITE <span class="m">2</span>*2
<span class="m">4</span>
YDB&gt;WRITE <span class="m">3</span>**2
<span class="m">9</span>
YDB&gt;WRITE <span class="m">4</span>/2
<span class="m">2</span>
YDB&gt;WRITE <span class="m">7</span>
<span class="m">2</span>
YDB&gt;WRITE <span class="m">7</span><span class="c1">#3</span>
<span class="m">1</span>
YDB&gt;
</pre></div>
</div>
<p>This simple example demonstrates how each arithmetic binary operation uses numeric literals.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE +<span class="s2">&quot;12ABC&quot;</span>
<span class="m">12</span>
YDB&gt;WRITE --<span class="s2">&quot;-3-4&quot;</span>
-3
YDB&gt;
</pre></div>
</div>
<p>The first WRITE shows the unary plus sign (+) operation forcing the numeric evaluation of a string literal. The second WRITE demonstrates the unary minus sign (-). Note the second minus sign within the string literal does not cause subtraction, but rather, terminates the numeric evaluation with the result of negative three (-3). Each of the leading minus signs causes one negation and therefore, the result is negative three (-3).</p>
</section>
<section id="logical-operators">
<h3><a class="toc-backref" href="langfeat.html#id45">Logical Operators</a><a class="headerlink" href="langfeat.html#logical-operators" title="Permalink to this heading">¶</a></h3>
<p>M logical operators always produce a result that is TRUE (1) or FALSE (0). All logical operators force M to evaluate the expressions to which they apply as truth-valued.</p>
<p>The logical operators are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘</p></td>
<td><p>unary NOT operator negates current truth-value;
M accepts placement of the NOT operator next to a relational operator, for example, A’=B meaning ‘(A=B), i.e., NAND
and next to logical operators, A’&amp; B meaning ‘(A &amp; B) i.e. NAND and A’! B meaning ‘(A ! B) i.e. NOR</p></td>
</tr>
<tr class="row-odd"><td><p>&amp;</p></td>
<td><p>binary AND operator produces a true result only if both of the expressions are true</p></td>
</tr>
<tr class="row-even"><td><p>!</p></td>
<td><p>binary OR operator produces a true result if either of the expressions is true</p></td>
</tr>
</tbody>
</table>
<p>Remember that precedence is always left to right, and that logical operators have the same precedence as all other operators.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE &#39;0
1
YDB&gt;WRITE &#39;1
0
YDB&gt;WRITE &#39;5689
0
YDB&gt;WRITE &#39;-1
0
YDB&gt;WRITE &#39;&quot;ABC&quot;
1
YDB&gt;
</pre></div>
</div>
<p>The above example demonstrates the unary NOT operation. Note that any non-zero numeric value is true and has a false negation.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="m">0</span><span class="p">&amp;</span><span class="m">0</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="m">0</span><span class="s1">&#39;&amp;0</span>
<span class="s1">1</span>
<span class="s1">YDB&gt;WRITE 1&amp;0</span>
<span class="s1">0</span>
<span class="s1">YDB&gt;WRITE 0&amp;1</span>
<span class="s1">0</span>
<span class="s1">YDB&gt;WRITE 1&amp;1</span>
<span class="s1">1</span>
<span class="s1">YDB&gt;WRITE 1&#39;</span><span class="p">&amp;</span><span class="m">1</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="m">2</span><span class="p">&amp;</span><span class="m">1</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="m">0</span>!0
<span class="m">0</span>
YDB&gt;WRITE <span class="m">0</span><span class="s1">&#39;!0</span>
<span class="s1">1</span>
<span class="s1">YDB&gt;WRITE 1!0</span>
<span class="s1">1</span>
<span class="s1">YDB&gt;WRITE 0!1</span>
<span class="s1">1</span>
<span class="s1">YDB&gt;WRITE 1!1</span>
<span class="s1">1</span>
<span class="s1">YDB&gt;WRITE 1&#39;</span>!1
<span class="m">0</span>
YDB&gt;WRITE <span class="m">2</span>!1
<span class="m">1</span>
YDB&gt;
</pre></div>
</div>
<p>The above example demonstrates cases covered by the binary logical operators.</p>
</section>
<section id="string-operators">
<span id="m-string-operators"></span><h3><a class="toc-backref" href="langfeat.html#id46">String Operators</a><a class="headerlink" href="langfeat.html#string-operators" title="Permalink to this heading">¶</a></h3>
<p>All string operators force M to evaluate the expressions to which they apply as strings.</p>
<p>The string operator is:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 92%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>_</p></td>
<td><p>binary operator causes M to concatenate the second expression with the first expression</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="s2">&quot;B&quot;</span>_<span class="s2">&quot;A&quot;</span>
BA
YDB&gt;WRITE <span class="s2">&quot;A&quot;</span>_1
A1
YDB&gt;
</pre></div>
</div>
<p>The above example demonstrates M concatenation.</p>
</section>
<section id="numeric-relational-operators">
<h3><a class="toc-backref" href="langfeat.html#id47">Numeric Relational Operators</a><a class="headerlink" href="langfeat.html#numeric-relational-operators" title="Permalink to this heading">¶</a></h3>
<p>M relational operators always generate a result of TRUE (1) or FALSE (0). All numeric relational operators force M to evaluate the expressions to which they apply as numeric.</p>
<p>The numeric relational operators are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&gt;</p></td>
<td><p>binary arithmetic greater than</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;</p></td>
<td><p>binary arithmetic less than</p></td>
</tr>
</tbody>
</table>
<p>The equal sign (=) does not force numeric evaluation, and should be viewed as a string operator. However, the equal sign between two numeric values tests for numeric equality.</p>
<p>Other numeric relations are formed using the logical NOT operator apostrophe (’) as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘&gt;</p></td>
<td><p>not greater than, that is, less than or equal to</p></td>
</tr>
<tr class="row-odd"><td><p>‘&lt;</p></td>
<td><p>not less than, that is, greater than or equal to</p></td>
</tr>
<tr class="row-even"><td><p>&gt;=</p></td>
<td><p>greater than or equal to, that is, not less than</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;=</p></td>
<td><p>less than or equal to, that is, not greater than</p></td>
</tr>
<tr class="row-even"><td><p>‘=</p></td>
<td><p>not equal, numeric or string operation</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="m">1</span>&gt;2
<span class="m">0</span>
YDB&gt;WRITE <span class="m">1</span>&lt;<span class="m">2</span>
<span class="m">1</span>
YDB&gt;
</pre></div>
</div>
<p>The above example demonstrates the basic arithmetic relational operations.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="m">1</span><span class="s1">&#39;&lt;2</span>
<span class="s1">0</span>
<span class="s1">YDB&gt;WRITE 2&#39;</span>&lt;<span class="m">1</span>
<span class="m">1</span>
YDB&gt;
</pre></div>
</div>
<p>The above example demonstrates combinations of arithmetic, relational operators with the logical NOT operator.</p>
</section>
<section id="string-relational-operators">
<h3><a class="toc-backref" href="langfeat.html#id48">String Relational Operators</a><a class="headerlink" href="langfeat.html#string-relational-operators" title="Permalink to this heading">¶</a></h3>
<p>M relational operators always generate a result of TRUE (1) or FALSE (0). All string relational operators force M to evaluate the expressions to which they apply as strings.</p>
<p>The string relational operators are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 94%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>=</p></td>
<td><p>binary operator causes M to produce a TRUE if the expressions are equal</p></td>
</tr>
<tr class="row-odd"><td><p>[</p></td>
<td><p>binary operator causes M to produce a TRUE if the first expression contains the ordered sequence of characters in the second expression</p></td>
</tr>
<tr class="row-even"><td><p>]</p></td>
<td><p>binary operator causes M to produce a TRUE if the first expression lexically follows the second expression in the character encoding sequence,
which by default is ASCII</p></td>
</tr>
<tr class="row-odd"><td><p>]]</p></td>
<td><p>binary operator causes M to produce a TRUE if the first expression lexically sorts after the second expression in the subscript collation sequence</p></td>
</tr>
</tbody>
</table>
<p>Note that all non-empty strings lexically follow the empty string, and every string contains the empty string.</p>
<p>Other string relations are formed using the logical NOT operator apostrophe (’) as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘[</p></td>
<td><p>does not contain</p></td>
</tr>
<tr class="row-odd"><td><p>‘]</p></td>
<td><p>does not follow, that is, lexically less than or equal to</p></td>
</tr>
<tr class="row-even"><td><p>‘]]</p></td>
<td><p>does not sort after, that is, lexically less than or equal to in the subscript collation sequence</p></td>
</tr>
<tr class="row-odd"><td><p>‘=</p></td>
<td><p>not equal, numeric or string operation</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="s2">&quot;A&quot;</span><span class="o">=</span><span class="s2">&quot;B&quot;</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="s2">&quot;C&quot;</span><span class="o">=</span><span class="s2">&quot;C&quot;</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="s2">&quot;A&quot;</span><span class="o">[</span><span class="s2">&quot;B&quot;</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="s2">&quot;ABC&quot;</span><span class="o">[</span><span class="s2">&quot;C&quot;</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="s2">&quot;A&quot;</span><span class="o">]</span><span class="s2">&quot;B&quot;</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="s2">&quot;B&quot;</span><span class="o">]</span><span class="s2">&quot;A&quot;</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="s2">&quot;A&quot;</span><span class="o">]]</span><span class="s2">&quot;B&quot;</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="s2">&quot;B&quot;</span><span class="o">]]</span><span class="s2">&quot;A&quot;</span>
<span class="m">1</span>
</pre></div>
</div>
<p>These examples demonstrate the string relational operators using string literals.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="m">2</span><span class="o">]</span><span class="m">10</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="m">2</span><span class="o">]]</span><span class="m">10</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="m">0</span><span class="o">]</span><span class="s2">&quot;</span>$<span class="s2">&quot;</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="m">0</span><span class="o">]]</span><span class="s2">&quot;</span>$<span class="s2">&quot;</span>
<span class="m">0</span>
</pre></div>
</div>
<p>These examples illustrate that when using the primary ASCII character set, the main difference in the “follows” (]) operator and the “sorts-after” (]]) operator is the way they treat numbers.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="nv">1</span><span class="o">=</span><span class="m">1</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="nv">1</span><span class="o">=</span><span class="m">2</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="nv">1</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="nv">1</span><span class="o">=</span><span class="m">01</span>
<span class="m">1</span>
YDB&gt;WRITE <span class="nv">1</span><span class="o">=</span><span class="s2">&quot;01&quot;</span>
<span class="m">0</span>
YDB&gt;WRITE <span class="nv">1</span><span class="o">=</span>+<span class="s2">&quot;01&quot;</span>
<span class="m">1</span>
YDB&gt;
</pre></div>
</div>
<p>These examples illustrate the dual nature of the equal sign operator. If both expressions are string or numeric, the results are straight forward. However, when the expressions are mixed, the native string data type prevails.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE &quot;a&quot;&#39;=&quot;A&quot;
1
YDB&gt;WRITE &quot;FRED&quot;&#39;[&quot;RED&quot;
0
YDB&gt;WRITE &quot;ABC&quot;&#39;]&quot;&quot;
0
</pre></div>
</div>
<p>These examples demonstrate combinations of the string relational operators with the NOT operator.</p>
</section>
<section id="pattern-match-operator">
<span id="pattern-match-op"></span><h3><a class="toc-backref" href="langfeat.html#id49">Pattern Match Operator</a><a class="headerlink" href="langfeat.html#pattern-match-operator" title="Permalink to this heading">¶</a></h3>
<p>The pattern match operator (?) causes M to return a TRUE if the expression ahead of the operator matches the characteristics described by the pattern following the operator. The pattern is not an expression.</p>
<p>Patterns are made up of two elements:</p>
<ol class="arabic simple">
<li><p>A repetition count</p></li>
<li><p>A pattern code, a string literal or an alternation list</p></li>
</ol>
<p>The element following the pattern match operator may consist of an indirection operator, followed by an element that evaluates to a legitimate pattern.</p>
<p>The repetition count consists of either a single integer literal or a period (.) delimiter with optional leading and trailing integer literals. A single integer literal specifies an exact repetition count. The period syntax specifies a range of repetitions where the leading number is a minimum and the trailing number is a maximum. When the repetition count is missing the leading number, M assumes there is no minimum, (i.e., a minimum of zero). When the repetition count is missing the trailing number, M does not place a maximum on the number of repetitions.</p>
<p>The pattern codes are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A</p></td>
<td><p>alphabetic characters upper or lower case</p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>control characters ASCII 0-31 and 127</p></td>
</tr>
<tr class="row-even"><td><p>E</p></td>
<td><p>any character; used to pass all characters in portions of the string where the
pattern is not restricted</p></td>
</tr>
<tr class="row-odd"><td><p>L</p></td>
<td><p>lower-case alphabetic characters, ASCII 97-122</p></td>
</tr>
<tr class="row-even"><td><p>N</p></td>
<td><p>digits 0-9, ASCII 48-57</p></td>
</tr>
<tr class="row-odd"><td><p>P</p></td>
<td><p>punctuation, ASCII 32-47, 58-64, 91-96, 123-126</p></td>
</tr>
<tr class="row-even"><td><p>U</p></td>
<td><p>upper-case alphabetic characters, ASCII 65-90</p></td>
</tr>
</tbody>
</table>
<p>Pattern codes may be upper or lower case and may be replaced with a string literal. YottaDB allows the M pattern match definition of patcodes A, C, N, U, L, and P to be extended or changed, (A can only be modified implicitly by modifying L or U) and new patcodes added. For detailed information on enabling this functionality, see <a class="reference external" href="internatn.html">Chapter 12: “Internationalization”</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The YottaDB compiler accepts pattern codes other than those explicitly defined above. If, at run-time, the pattern codes come into use and no pattern definitions are available, YottaDB issues a run-time error (PATNOTFOUND). YottaDB does not currently implement a mechanism for Y and Z patterns and continues to treat those as compile-time syntax errors. YottaDB defers literal optimizations involving patterns within an XECUTE as well as evaluations that encounter issues with the pattern table.</p>
</div>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;WRITE <span class="s2">&quot;ABC&quot;</span>?3U
<span class="m">1</span>
YDB&gt;WRITE <span class="s2">&quot;123-45-6789&quot;</span>?3N1<span class="s2">&quot;-&quot;</span>2N1<span class="s2">&quot;-&quot;</span>4N
<span class="m">1</span>
</pre></div>
</div>
<p>The first WRITE has a simple one-element pattern while the second has multiple elements including both codes and string literals. All the repetition counts are fixed.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>I x?.E1C.E W !,&quot;Must not contain a control character&quot; Q
</pre></div>
</div>
<p>This example uses a pattern match to test for control characters.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>I acn?1U.20A1&quot;,&quot;1U.10A D
.S acn=$G((^ACX($P(acn,&quot;,&quot;),$P(acn,&quot;,&quot;,2)))
</pre></div>
</div>
<p>This example uses a pattern match with implicit minimums to determine that an “account number” is actually a name, and to trigger a look-up of the corresponding account number in the ^ACX cross index.</p>
<p>The pattern match operator accepts the alteration syntax. Alteration consists of a repeat count followed by a comma-delimited list of patatoms enclosed in parentheses “()”. This is to check if any of the listed patterns matches the operand string. For example, ?1(2N1”-“7N,3N1”-“2N1”-“4N).1U might be a way to match either a social security number or a taxpayer ID. Since alteration is defined as one of the ways of constructing a patatom, alteration can nest (be used recursively).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Complex pattern matches may not be efficient to evaluate, so every effort should be made to simplify any commonly used pattern and to determine if more efficient alternative logic would be more appropriate.</p>
</div>
</section>
</section>
<section id="id3">
<h2><a class="toc-backref" href="langfeat.html#id50">Commands</a><a class="headerlink" href="langfeat.html#id3" title="Permalink to this heading">¶</a></h2>
<p>M commands may be abbreviated to a defined prefix. Most commands have arguments. However, some commands have either optional arguments or no arguments. When a command has no argument and is followed by more commands on the same line, at least two spaces (&lt;SP&gt;) must follow the command without arguments. Commands that accept arguments generally accept multiple arguments on the same command. M treats multiple arguments the same as multiple occurrences of the same command, each with its own argument.</p>
<section id="postconditionals">
<h3><a class="toc-backref" href="langfeat.html#id51">Postconditionals</a><a class="headerlink" href="langfeat.html#postconditionals" title="Permalink to this heading">¶</a></h3>
<p>M provides postconditionals as a tool for placing a condition on the execution of a single command and, in some cases, a single command argument. A postconditional consists of a colon (:) delimiter followed by a truth-valued expression. When the expression evaluates to true, M executes the command occurrence. When the expression evaluates to false, M does not execute the command occurrence.</p>
<p><strong>Command Postconditionals</strong></p>
<p>Command postconditionals appear immediately following a command and apply to all arguments for the command when it has multiple arguments. All commands except commands that themselves have a conditional aspect accept a command postconditional. Among the M standard commands, ELSE, FOR, and IF do not accept command postconditionals. All the YottaDB command extensions accept command postconditionals. When a postconditional evaluates to a literal FALSE (0), YottaDB discards the command and its arguments at compile time, which means it does not perform any validity checking on the arguments.</p>
<p><strong>Argument Postconditionals</strong></p>
<p>Commands that affect the flow of control may accept postconditionals on individual command arguments. Because multiple arguments act as multiple commands, this is a straight-forward application of the same principal as command postconditional. The only M standard commands that accept argument postconditionals are DO, GOTO, and XECUTE. The YottaDB command extensions that accept argument postconditionals are BREAK, ZGOTO, and ZSYSTEM.</p>
</section>
<section id="timeouts">
<h3><a class="toc-backref" href="langfeat.html#id52">Timeouts</a><a class="headerlink" href="langfeat.html#timeouts" title="Permalink to this heading">¶</a></h3>
<p>M provides timeouts as a tool to retain program control over commands of indefinite duration. A timeout consists of a colon (:) delimiter on an argument, followed by a numeric expression specifying the number of seconds to millisecond (three decimal place) precision for M to attempt to execute the command. When the timeout is zero (0), M makes a single attempt to complete the command.</p>
<p>YottaDB caps the maximum timeout to 2,147,483.647 seconds (about 24.8 days), and converts values greater than the maximum timeout to that cap. When a command has a timeout, M maintains the $TEST intrinsic special variable as the command completes. If the command completes successfully, M sets $TEST to TRUE (1). If the command times out before successful completion, M sets $TEST to FALSE (0). When a command argument does not specify a timeout, M does not maintain $TEST.</p>
<p>The following commands accept timeouts:</p>
<ul class="simple">
<li><p>LOCK</p></li>
<li><p>JOB</p></li>
<li><p>OPEN</p></li>
<li><p>READ</p></li>
<li><p>ZALLOCATE</p></li>
</ul>
<p>When a READ times out, M returns any characters that have arrived between the start of the command and the timeout. M does not produce any partial results for any of the other timed commands.</p>
</section>
</section>
<section id="m-locks">
<span id="id4"></span><h2><a class="toc-backref" href="langfeat.html#id53">M Locks</a><a class="headerlink" href="langfeat.html#m-locks" title="Permalink to this heading">¶</a></h2>
<p>The LOCK command reserves one or more resource names. Only one process at a time can reserve a resource name. Resource names follow exactly the same formation rules as M variables. They may be unsubscripted or subscripted and may or may not have a leading caret (^) prefix. M code commonly uses LOCKs as flags that control access to global data. Generally, a LOCK specifies the resource with the same name as the global variable that requires protected access. However, this is only a convention. LOCKing does not keep two or more processes from modifying the same global variable. It only keeps another process from LOCKing the same resource name at the same time.</p>
<p>M LOCKs are hierarchical. If one process holds a LOCK on a resource, no other process can LOCK either an ancestor or a descendant resource. For example, a LOCK on ^A(1,2) blocks LOCKs on either ^A(1), or ^A(1,2,3), but not on, for example, ^A(2) or its descendants.</p>
<p>A LOCK argument may contain any subscripted or unsubscripted M variable name including a name without a preceding caret symbol (^). As they have the appearance of local variable names, resource names with no preceding caret symbol (^) are commonly referred to as “local LOCKs” even though these LOCKs interact with other processes. For more information on the interaction between LOCKs and processes, refer to the <a class="reference external" href="../AdminOpsGuide/mlocks.html">LKE chapter in the Administration and Operations Guide</a>.</p>
<p>The YottaDB run-time system records LOCK information in memory associated with the region holding the global of the same name. However, YottaDB does not place LOCKs in the database structures that hold the globals. Instead the LOCK manager sets up a “LOCK database” associated with each database region. Only the M commands LOCK, ZALLOCATE, and ZDEALLOCATE and the LKE utility access the information in the LOCK database.</p>
<p>YottaDB distributes the LOCK database within space associated with the database files identified by the Global Directory (GD). The Global Directory Editor (GDE) enables you to create and maintain global directories. YottaDB associates LOCKs of resource names starting with a caret symbol (^) with the database region used to map variables with the same name. If the global directory maps the name ^A to file A.DAT, YottaDB maps all LOCKs on resource name ^A to LOCK space implemented in shared memory control structures associated with A.DAT. YottaDB maps LOCKs on names not starting with a caret symbol (^) to the region of the database specified with the GDE command LOCKS -REGION.</p>
<p>By default, GDE creates global directories mapping “local” LOCKs to the region DEFAULT.</p>
<p>^LOCKS automatically intersect for all users of the same data in any database file, because YottaDB associates the ^LOCKs with the same region as the global variables with the same name.</p>
<p>“Local” LOCK intersections are dependent on the global directory, because users may access the database through different global directories. The “local” LOCKs of two processes interact with each other only when the same lock resource names map to the same database region.</p>
</section>
<section id="intrinsic-functions">
<h2><a class="toc-backref" href="langfeat.html#id54">Intrinsic Functions</a><a class="headerlink" href="langfeat.html#intrinsic-functions" title="Permalink to this heading">¶</a></h2>
<p>M Intrinsic Functions start with a single dollar sign ($) and have one or more arguments enclosed in parentheses () and separated by commas (,). These functions provide an expression result by performing actions that would be impossible or difficult to perform using M commands. It is now possible to invoke a C function in a package via the external call mechanism. For information on the functions, see <a class="reference external" href="functions.html">Chapter 7: “Functions”</a>.</p>
</section>
<section id="id5">
<h2><a class="toc-backref" href="langfeat.html#id55">Intrinsic Special Variables</a><a class="headerlink" href="langfeat.html#id5" title="Permalink to this heading">¶</a></h2>
<p>M Intrinsic Special Variables start with a single dollar sign ($). YottaDB provides such variables for program examination. In some cases, the Intrinsic Special Variables may be SET to modify the corresponding part of the environment. For information, see <a class="reference external" href="isv.html">Chapter 8: “Intrinsic Special Variables”</a>.</p>
</section>
<section id="routines">
<h2><a class="toc-backref" href="langfeat.html#id56">Routines</a><a class="headerlink" href="langfeat.html#routines" title="Permalink to this heading">¶</a></h2>
<p>M routines have a name and consist of lines of code followed by a formfeed. M separates the name of a routine from the body of the routine with an end-of-line which is a line-feed. This form is mostly used for interchange with other M implementations and can be read and written by the %RI and %RO utility routines.</p>
<p>YottaDB stores routine sources in UNIX text files.</p>
<p>In M, a routine has no particular impact on variable management and may include code that is invoked at different times and has no logical intersection.</p>
<section id="lines">
<h3><a class="toc-backref" href="langfeat.html#id57">Lines</a><a class="headerlink" href="langfeat.html#lines" title="Permalink to this heading">¶</a></h3>
<p>A line of M code consists of the following elements in the following order:</p>
<ul class="simple">
<li><p>An optional label.</p></li>
<li><p>A line-start delimiter. The standard defines the line-start delimiter as a space (&lt;SP&gt;) character. In order to enhance routine readability, YottaDB extends M by accepting one or more tab (&lt;HT&gt;) characters as line-start delimiters.</p></li>
<li><p>Zero or more level indicators, which are periods (.). The level indicators show the level of nesting for argumentless DO commands: the more periods, the deeper the nesting. M ignores lines that contain level indicators unless they directly follow an argumentless DO command with a matching level of nesting. For more information on the DO command, see <a class="reference external" href="commands.html">Chapter 6: “Commands”</a>.</p></li>
<li><p>Zero or more commands and their arguments. M accepts multiple commands on a line. The argument(s) of one command are separated from the next command by a command-start delimiter, consisting of one or more spaces (&lt;SP&gt;).</p></li>
<li><p>A terminating end-of-line, which is a line feed.</p></li>
</ul>
<p><strong>Labels</strong></p>
<p>In addition to labels that follow the rules for M names, M accepts labels consisting only of digits. In a label consisting only of digits, leading zeros are considered significant. For example, labels 1 and 01 are different. Formallists may immediately follow a label. A Formallist consists of one or more names enclosed in parentheses (). Formallists identify local variables that “receive” passed values in M parameter passing. For more information, see <a class="reference internal" href="langfeat.html#parameter-passing"><span class="std std-ref">Parameter Passing</span></a>.</p>
<p>In YottaDB, a colon (:) delimiter may be appended to the label, which causes the label to be treated as “local.” Within the routine in which they appear, they perform exactly as they would without the trailing colon but they are available only during compilation and inaccessible to other routines and to indirection or XECUTE. Because references to local labels preceding their position in a routine produce a LABELUNKNOWN error at run-time, YottaDB recommends omitting the routinename from labelrefs to a local label. Using local labels reduces object size and linking overhead for all types of dynamic linking except indirection and XECUTE. Use of local labels may either improve or impair performance; typically any difference is modest. The more likely they are to all be used within the code block at run-time, the more likely an improvement. In other words, conditional code paths which prevent all references to local variables appearing in the block may actually impair performance.</p>
<p><strong>Comments</strong></p>
<p>In addition to commands, a line may also contain a comment that starts with a leading semi-colon (;) delimiter. The scope of a comment is the remainder of the line. In other words, M ignores anything to the right of the comment delimiter. The standard defines the comment delimiter (;) as it would a command, and therefore requires that it always appear after a linestart. YottaDB extends the standard to permit comments to start at the first character of a line or in an argument position.</p>
</section>
<section id="entry-references">
<h3><a class="toc-backref" href="langfeat.html#id58">Entry References</a><a class="headerlink" href="langfeat.html#entry-references" title="Permalink to this heading">¶</a></h3>
<p>M entryrefs provide a generalized target for referring to a line within a routine. An entryref may contain some combination of a label, an offset, and a routine name (in that order). The offset is delimited by a plus sign (+) and the routinename is delimited by a caret symbol(^). When an entryref does not contain a label, M assumes the offset is from the beginning of the routine. When an entryref does not contain an offset, M uses an offset of zero (0). When an entryref does not contain a routine name, M assumes the routine that is currently executing.</p>
<p>M permits every element in an entryref to have the form of an indirection operator, followed by an element that evaluates to a legitimate occurrence of that portion of the entryref.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>YottaDB accepts an offset without a label (for example +3^RTN) for an entryref argument to DO, GOTO and ZGOTO but prohibits the same during parameter passing with the JOB command.</p>
</div>
<p>Offsets provide an extremely useful tool for debugging. However, avoid their use in production code because they generally produce maintenance problems.</p>
</section>
<section id="label-references">
<h3><a class="toc-backref" href="langfeat.html#id59">Label References</a><a class="headerlink" href="langfeat.html#label-references" title="Permalink to this heading">¶</a></h3>
<p>M labelrefs are a subset of entryrefs that exclude offsets and separate indirection. Labelrefs are used with parameter passing.</p>
</section>
</section>
<section id="indirection">
<h2><a class="toc-backref" href="langfeat.html#id60">Indirection</a><a class="headerlink" href="langfeat.html#indirection" title="Permalink to this heading">¶</a></h2>
<p>M provides indirection as a means to defer definition of elements of the code until run-time. Indirection names a variable that holds or “points” to the element. The indirection operator is the “at” symbol (&#64;).</p>
<section id="argument-indirection">
<h3><a class="toc-backref" href="langfeat.html#id61">Argument Indirection</a><a class="headerlink" href="langfeat.html#argument-indirection" title="Permalink to this heading">¶</a></h3>
<p>Most commands accept indirection of their entire argument.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;set <span class="nv">x</span><span class="o">=</span><span class="s2">&quot;^INDER&quot;</span>
YDB&gt;do @x
</pre></div>
</div>
<p>This example is equivalent to do ^INDER.</p>
</section>
<section id="atomic-indirection">
<h3><a class="toc-backref" href="langfeat.html#id62">Atomic Indirection</a><a class="headerlink" href="langfeat.html#atomic-indirection" title="Permalink to this heading">¶</a></h3>
<p>Any expratom or any local or global variable name may be replaced by indirection.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;set <span class="nv">x</span><span class="o">=</span><span class="s2">&quot;HOOP&quot;</span>,b<span class="o">=</span><span class="s2">&quot;x&quot;</span>
YDB&gt;set <span class="nv">a</span><span class="o">=</span><span class="s2">&quot;HULA &quot;</span>_@b
YDB&gt;write a
HULA HOOP
YDB&gt;
</pre></div>
</div>
<p>This example uses indirection within a concatenation operation.</p>
</section>
<section id="entryref-indirection">
<h3><a class="toc-backref" href="langfeat.html#id63">Entryref Indirection</a><a class="headerlink" href="langfeat.html#entryref-indirection" title="Permalink to this heading">¶</a></h3>
<p>Any element of an entryref may be replaced by indirection.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;set <span class="nv">lab</span><span class="o">=</span><span class="s2">&quot;START&quot;</span>,routine<span class="o">=</span><span class="s2">&quot;PROG&quot;</span>
YDB&gt;do @lab^@routine
</pre></div>
</div>
<p>This example is equivalent to do START^PROG.</p>
</section>
<section id="pattern-code-indirection">
<h3><a class="toc-backref" href="langfeat.html#id64">Pattern Code Indirection</a><a class="headerlink" href="langfeat.html#pattern-code-indirection" title="Permalink to this heading">¶</a></h3>
<p>A pattern code may be replaced by indirection.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;FOR <span class="nv">p</span><span class="o">=</span><span class="s2">&quot;1U.20A1&quot;&quot;,&quot;&quot;1U.20A&quot;</span>,<span class="s2">&quot;5N&quot;</span> IF x?@p QUIT
YDB&gt;ELSE WRITE !,<span class="s2">&quot;Incorrect format&quot;</span> QUIT
</pre></div>
</div>
<p>This example uses pattern code indirection to test x for either a five-digit number, or a name consisting of two comma separated pieces, each starting with an upper case letter and followed by up to twenty alphabetic characters.</p>
</section>
<section id="name-indirection">
<h3><a class="toc-backref" href="langfeat.html#id65">Name Indirection</a><a class="headerlink" href="langfeat.html#name-indirection" title="Permalink to this heading">¶</a></h3>
<p>Indirection may replace the prefix of a subscripted global or local variable name. This “name” indirection requires two indirection operators, a leading operator similar to the other forms of indirection, and a trailing operator marking the transition to those subscripts that are not specified by indirection.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;SET <span class="nv">from</span><span class="o">=</span><span class="s2">&quot;B&quot;</span>,to<span class="o">=</span><span class="s2">&quot;^A(15)&quot;</span>,x<span class="o">=</span><span class="s2">&quot;&quot;</span>
YDB&gt;FOR SET <span class="nv">x</span><span class="o">=</span><span class="nv">$O</span><span class="o">(</span>@from@<span class="o">(</span>x<span class="o">))</span> Q:x<span class="o">=</span><span class="s2">&quot;&quot;</span> S @to@<span class="o">(</span>x<span class="o">)=</span>@from@<span class="o">(</span>x<span class="o">)</span>
</pre></div>
</div>
<p>This example uses name indirection to copy the level contents of a local array to a part of a global array. The example assumes that all existing first level nodes of variable B have data.</p>
</section>
<section id="indirection-concerns">
<h3><a class="toc-backref" href="langfeat.html#id66">Indirection Concerns</a><a class="headerlink" href="langfeat.html#indirection-concerns" title="Permalink to this heading">¶</a></h3>
<p>M indirection provides a very powerful tool for allowing program abstraction. However, because indirection is frequently unnecessary and has some disadvantages, use it carefully.</p>
<p>Because routines that use indirection in some ways do not contain adequate information for easy reading, such routines tend to be more difficult to debug and maintain.</p>
<p>To improve run-time performance, YottaDB tends to move work from run-time to compile-time. Indirection forces compiler actions to occur at run-time, which minimizes the benefits of compilation.</p>
<p>M allows most forms of indirection to be recursive. However, in real applications, recursive indirection typically makes the code obscure and slow.</p>
<p>There are circumstances where indirection serves a worthwhile purpose. For instance, certain utility functions with a general nature may be clearly abstracted and coded using indirection. Because M has no “CASE” command, DO (or GOTO) with argument indirection provides a clear solution to the problem of providing complex branching.</p>
<p>Some M users prototype with indirection and then replace indirection with generated code that reduces run-time overhead. In any case, always consider whether indirection can be replaced with a clearer or more efficient approach.</p>
<p>Run-time errors from indirection or XECUTEs maintain $STATUS and $ZSTATUS related information and cause normal error handling but do not provide compiler supplied information on the location of any error within the code fragment.</p>
</section>
</section>
<section id="parameter-passing">
<span id="id7"></span><h2><a class="toc-backref" href="langfeat.html#id67">Parameter Passing</a><a class="headerlink" href="langfeat.html#parameter-passing" title="Permalink to this heading">¶</a></h2>
<p>Parameter passing provides a way of explicitly controlling some or all of the variable context transferred between M routines.</p>
<p>M uses parameter passing for:</p>
<ul class="simple">
<li><p>A DO command with parameters</p></li>
<li><p>Extrinsic functions and special variables</p></li>
</ul>
<p>Parameter passing is optional on DO commands.</p>
<p>Parameter passing uses two argument lists: the actuallist that specifies the parameters that M passes to an invoked routine, and the formallist that specifies the local variables to receive or associate with the parameters.</p>
<section id="actuallists">
<h3><a class="toc-backref" href="langfeat.html#id68">Actuallists</a><a class="headerlink" href="langfeat.html#actuallists" title="Permalink to this heading">¶</a></h3>
<p>An actuallist specifies the parameters M passes to the invoked routine. The actuallist contains a list of zero or more parameters enclosed in parentheses, immediately following a DO or extrinsic function.</p>
<p>An actuallist:</p>
<ul class="simple">
<li><p>Is made up of items separated by commas</p></li>
<li><p>Contains expressions and/or actualnames. Items may be missing, that is, two commas may appear next to each other, with nothing between them.</p></li>
<li><p>Must be used in an invocation of a label with a formallist, except in the case of extrinsic special variables.</p></li>
<li><p>Must not contain undefined variables.</p></li>
<li><p>Must not have more items than a formallist with which it is used.</p></li>
<li><p>May contain the same item in more than one position.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;DO MULT<span class="o">(</span><span class="m">3</span>,X,.RESULT<span class="o">)</span>
</pre></div>
</div>
<p>This example illustrates a DO with parameters. The actuallist contains:</p>
<ul class="simple">
<li><p>3 - a numeric literal</p></li>
<li><p>X - a local variable</p></li>
<li><p>.RESULT - an actualname</p></li>
</ul>
</section>
<section id="actualnames">
<h3><a class="toc-backref" href="langfeat.html#id69">Actualnames</a><a class="headerlink" href="langfeat.html#actualnames" title="Permalink to this heading">¶</a></h3>
<p>An actualname starts with a leading period (.) delimiter, followed by an unsubscripted local variable name. Actualnames identify variables that are passed by reference, as described in a subsequent section. While expressions in an actualname are evaluated when control is transferred to a formallabel, the variables identified by actualnames are not; therefore, they do not need to be defined at the time control is transferred.</p>
</section>
<section id="formallists">
<h3><a class="toc-backref" href="langfeat.html#id70">Formallists</a><a class="headerlink" href="langfeat.html#formallists" title="Permalink to this heading">¶</a></h3>
<p>A formallist specifies the variables M uses to hold passed values. A formallist contains a list of zero or more parameters enclosed in parentheses, immediately following a label.</p>
<p>A formallist:</p>
<ul class="simple">
<li><p>Is made up of items separated by commas.</p></li>
<li><p>Contains unsubscripted local variable names.</p></li>
<li><p>Must be used and only used with a label invoked with an actuallist or an extrinsic.</p></li>
<li><p>May contain undefined variables.</p></li>
<li><p>May have more items than an actuallist with which it is used.</p></li>
<li><p>Must not contain the same item in more than one position.</p></li>
<li><p>Must contain at least as many items as the actuallist with which it is used.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MULT(MP,MC,RES)
SET RES=MP*MC
QUIT RES
</pre></div>
</div>
<p>In this example, illustrating a simple parameterized routine, the formallist contains the following items:</p>
<ul class="simple">
<li><p>MP</p></li>
<li><p>MC</p></li>
<li><p>RES</p></li>
</ul>
<p>An example in the section describing “Actuallists” shows an invocation that matches this routine.</p>
</section>
<section id="formallabel">
<h3><a class="toc-backref" href="langfeat.html#id71">Formallabel</a><a class="headerlink" href="langfeat.html#formallabel" title="Permalink to this heading">¶</a></h3>
<p>A label followed by a formallist is called a formallabel.</p>
</section>
<section id="parameter-passing-operation">
<h3><a class="toc-backref" href="langfeat.html#id72">Parameter Passing Operation</a><a class="headerlink" href="langfeat.html#parameter-passing-operation" title="Permalink to this heading">¶</a></h3>
<p>M performs an implicit NEW on the formallist names and replaces the formallist items with the actuallist items.</p>
<p>M provides the actuallist values to the invoked procedure by giving each element in the formallist the value or reference provided by the corresponding element in the actuallist. M associates the first name in the formallist with the first item in the actuallist, the second name in the formallist with the second item in the actuallist and so on. If the actuallist is shorter than the formallist, M ensures that the formallist items with no corresponding value are in effect NEWed. If the formallist item has no corresponding item in the actuallist (indicated by two adjacent commas in the actuallist), that item in the formallist becomes undefined.</p>
<p>If the actuallist item is an expression and the corresponding formallist variable is an array, parameter passing does not affect the subscripted elements of the array. If an actualname corresponds to a formallist variable, M reflects array operations on the formallist variable, by reference, in the variable specified by the actualname.</p>
<p>M treats variables that are not part of the formallist as if parameter passing did not exist (i.e., M makes them available to the invoked routine).</p>
<p>M initiates execution at the first command following the formallabel.</p>
<p>A QUIT command terminates execution of the invoked routine. At the time of the QUIT, M restores the formallist items to the values they had at the invocation of the routine.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the case where a variable name appears as an actualname in the actuallist, and also as a variable in the formallist, the restored value reflects any change made by reference.</p>
</div>
<p>A QUIT from a DO does not take an argument, while a QUIT from an extrinsic must have an argument. This represents one of the two major differences between the DO command with parameters and the extrinsics. M returns the value of the QUIT command argument as the value of the extrinsic function or special variable. The other difference is that M stacks $TEST for extrinsics.</p>
<p>For more information, see <a class="reference internal" href="langfeat.html#extrinsic-functions"><span class="std std-ref">Extrinsic Functions</span></a> and <a class="reference internal" href="langfeat.html#extrinsic-special-vars"><span class="std std-ref">Extrinsic Special Variables</span></a>.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET X=30,Z=&quot;Hello&quot;
DO WRTSQR(X)
ZWRITE
QUIT
WRTSQR(Z)
SET Z=Z*Z
WRITE Z,!
QUIT
</pre></div>
</div>
<p>produces</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>900
X=30
Z=&quot;Hello&quot;
</pre></div>
</div>
</section>
<section id="parameter-passing-mechanisms">
<h3><a class="toc-backref" href="langfeat.html#id73">Parameter Passing Mechanisms</a><a class="headerlink" href="langfeat.html#parameter-passing-mechanisms" title="Permalink to this heading">¶</a></h3>
<p>M passes the actuallist values to the invoked routine using two parameter-passing mechanisms:</p>
<ul class="simple">
<li><p>Call-by-Value - where expressions appear</p></li>
<li><p>Call-by-Reference - where actualnames appear</p></li>
</ul>
<p>A call-by-value passes a copy of the value of the actuallist expression to the invoked routine by assigning the copy to a formallist variable. If the parameter is a variable, the invoked routine may change that variable. However, because M constructs that variable to hold the copy, it deletes the variable holding the copy when the QUIT restores the prior formallist values. This also means that changes to the variable by the invoked routine do not affect the value of the variable in the invoking routine.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET X=30
DO SQR(X)
ZWRITE
QUIT
SQR(Z)SET Z=Z*Z
QUIT
</pre></div>
</div>
<p>produces:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>X=30
</pre></div>
</div>
<p>A period followed by a name identifies an actualname and causes a call-by-reference.</p>
<p>A call-by-reference passes a pointer to the variable of the invoked routine so operations on the assigned formallist variable also act on the actualname variable. Changes, including KILLs to the formallist variable, immediately have the same affect on the corresponding actualname variable. This means that M passes changes to formallist variables in the invoked routine back to the invoking routine as changes in actualname variables.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET X=30
DO SQR(.X)
ZWRITE
QUIT
SQR(Z)SET Z=Z*Z
QUIT
</pre></div>
</div>
<p>produces:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>X=900
</pre></div>
</div>
</section>
<section id="parameter-passing-extensions">
<h3><a class="toc-backref" href="langfeat.html#id74">Parameter Passing Extensions</a><a class="headerlink" href="langfeat.html#parameter-passing-extensions" title="Permalink to this heading">¶</a></h3>
<p>The standard does not provide for indirection of a labelref because the syntax has an ambiguity.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DO @X(1)
</pre></div>
</div>
<p>This example could be:</p>
<ul class="simple">
<li><p>An invocation of the label specified by X with a parameter of 1.</p></li>
<li><p>An invocation of the label specified by X(1) with no parameter list.</p></li>
</ul>
<p>YottaDB processes the latter interpretation as illustrated in the following example.</p>
<p>Example:</p>
<p>The syntax:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET A(1)=&quot;CUBE&quot;,X=5
DO @A(1)(.X)
WRITE X,!
QUIT
CUBE(C);cube a variable
SET C=C*C*C
QUIT
</pre></div>
</div>
<p>Produces the result:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>125
</pre></div>
</div>
<p>YottaDB follows analogous syntax for routine indirection:</p>
<p><strong>DO ^&#64;X(A)</strong> invokes the routine specified by X(A).</p>
<p><strong>DO ^&#64;(X)(A)</strong> invokes the routine specified by X and passes the parameter A.</p>
<p><strong>DO ^&#64;X(A)(A)</strong> invokes the routine specified by X(A) and passes the parameter A.</p>
</section>
</section>
<section id="external-calls">
<span id="ext-calls"></span><h2><a class="toc-backref" href="langfeat.html#id75">External Calls</a><a class="headerlink" href="langfeat.html#external-calls" title="Permalink to this heading">¶</a></h2>
<p>YottaDB allows references to a YottaDB database from programs written in other programming languages that run under UNIX.</p>
<p>In YottaDB, calls to C language routines may be made with the following syntax:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DO &amp;[packagename.]name[^name][parameter-list]
</pre></div>
</div>
<p>or as an expression element,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$&amp;[packagename.]name[^name][parameter-list]
</pre></div>
</div>
<p>Where packagename, like the name elements is a valid M name. Because of the parsing conventions of M, the identifier between the ampersand (&amp;) and the optional parameter-list has precisely constrained punctuation – a later section describes how to transform this into a more richly punctuated name should that be appropriate for the called function. While the intent of the syntax is to permit the name^name to match an M labelref, there is no semantic implication to any use of the caret (^).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information on external calls, see <a class="reference external" href="extrout.html">Chapter 11: “Integrating External Routines”</a>.</p>
</div>
</section>
<section id="extrinsic-functions">
<span id="id9"></span><h2><a class="toc-backref" href="langfeat.html#id76">Extrinsic Functions</a><a class="headerlink" href="langfeat.html#extrinsic-functions" title="Permalink to this heading">¶</a></h2>
<p>An extrinsic function is an M subroutine that another M routine can invoke to return a value.</p>
<p>The format for extrinsic functions is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$$[label][^routinename]([expr|.lname[,...]])
</pre></div>
</div>
<ul class="simple">
<li><p>The optional label and optional routinename make up the formallabel that specifies the name of the subroutine performing the extrinsic function. The formallabel must contain at least one of its optional components.</p></li>
<li><p>The optional expressions and actualnames make up the actuallist that specifies the list of actual parameters M passes to the invoked routine.</p></li>
</ul>
<p>M stacks $TEST for extrinsic functions. This is one of the two major differences between the DO command with parameters and extrinsics. On return from an extrinsic function, M restores the value of $TEST to what it was before the extrinsic function, regardless of the actions executed by the invoked routine.</p>
<p>M requires a routine that implements an extrinsic function to terminate with an explicit QUIT command which has an argument. M returns the value of the QUIT command argument as the value of the extrinsic function. This is the other major difference between the DO command with parameters and extrinsics. It is now possible to invoke a C function in a package via the external call mechanism.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>POWER(V,X,S,T);extrinsic to raise to a power
;ignores fractional powers
SET T=1,S=0
IF X&lt;0 SET X=-X,S=1
FOR X=1:1:X S T=T*V
QUIT $S(S:1/T,1:T)
YDB&gt; WRITE $$^POWER(3,4)
81
YDB&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The POWER routine uses a formallist that is longer than the “expected” actuallist to protect local working variables. Such a practice may be encouraged or discouraged by your institution’s standards.</p>
</div>
</section>
<section id="extrinsic-special-variables">
<span id="extrinsic-special-vars"></span><h2><a class="toc-backref" href="langfeat.html#id77">Extrinsic Special Variables</a><a class="headerlink" href="langfeat.html#extrinsic-special-variables" title="Permalink to this heading">¶</a></h2>
<p>An extrinsic special variable is a user-written M subroutine that another M routine can invoke to return a value.</p>
<p>The format for extrinsic special variables is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$$[label][^routinename]
</pre></div>
</div>
<ul class="simple">
<li><p>The optional label and optional routinename make up the formallabel, which specifies the name of the subroutine performing the extrinsic function. The formallabel must contain at least one of its optional component.</p></li>
</ul>
<p>An extrinsic special variable can be thought of as an extrinsic function without input parameters. $ $ x is equivalent in operation to $ $ x(). Extrinsic special variables are the only case where invocation of a formallabel does not require an actuallist. M stacks $TEST for extrinsic special variables.</p>
<p>M requires that a routine that implements an extrinsic special variable terminate with an explicit QUIT command which has an argument. M returns the value of the QUIT command argument as the value of the extrinsic special variable.</p>
<p>Example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>YDB&gt;ZPRINT ^DAYOWEEK
DAYOWEEK<span class="o">()</span><span class="p">;</span>extrinsic special variable to
<span class="p">;</span>provide the day of the week
QUIT <span class="nv">$ZD</span><span class="o">(</span><span class="nv">$H</span>,<span class="s2">&quot;DAY&quot;</span><span class="o">)</span>
YDB&gt;WRITE <span class="nv">$$</span>DAYOWEEK^DAYOWEEK
MON
</pre></div>
</div>
</section>
<section id="transaction-processing">
<h2><a class="toc-backref" href="langfeat.html#id78">Transaction Processing</a><a class="headerlink" href="langfeat.html#transaction-processing" title="Permalink to this heading">¶</a></h2>
<p>Transaction Processing (TP) provides a way for M programs to organize database updates into logical groups that occur as a single event (i.e., either all the database updates in a transaction occur, or none of them occur). With a properly constructed transaction, no other actor or process behaves as if it observed any intermediate state. Transaction processing has been designed to improve throughput and minimize the possibility and impact of “live lock” conditions.</p>
<section id="tp-definitions">
<h3><a class="toc-backref" href="langfeat.html#id79">TP Definitions</a><a class="headerlink" href="langfeat.html#tp-definitions" title="Permalink to this heading">¶</a></h3>
<p>In M, a transaction is a sequence of commands that begins with a TSTART command, ends with a TCOMMIT command, and is not within the scope of another transaction. Applications can nest TSTART/TCOMMIT commands to create sub-transactions, but sub-transactions only commit at the outer-most TCOMMIT. $TLEVEL greater than 1 indicates sub-transaction nesting.</p>
<p>A successful transaction ends with a COMMIT that is triggered by the TCOMMIT command at the end of the transaction. A COMMIT causes all the database updates performed within the transaction to become available to other processes.</p>
<p>An unsuccessful transaction ends with a ROLLBACK. ROLLBACK is invoked explicitly by the TROLLBACK command, or implicitly at a process termination that occurs during a transaction in progress. An error within a transaction does not cause an implicit ROLLBACK. A ROLLBACK removes any database updates performed within the transaction before they are made available to other processes. ROLLBACK also releases all resources LOCKed since the start of the transaction, and makes the naked reference undefined.</p>
<p>A RESTART is a transfer of control to the TSTART at the beginning of the transaction. RESTART implicitly includes a ROLLBACK and may optionally restore local variables to the values they had when the initial TSTART was originally executed. A RESTART always restores $TEST and the naked reference to the values they had when the initial TSTART was executed. RESTART does not manage device state information. A RESTART is invoked by the TRESTART command or by M if it is determined that the transaction is in conflict with other database updates. RESTART can only successfully occur if the initial TSTART includes an argument that enables RESTART.</p>
</section>
<section id="key-considerations-writing-tp-code">
<h3><a class="toc-backref" href="langfeat.html#id80">Key Considerations - Writing TP Code</a><a class="headerlink" href="langfeat.html#key-considerations-writing-tp-code" title="Permalink to this heading">¶</a></h3>
<p>Some key considerations for writing application code between TSTART and TCOMMIT are as follows:</p>
<ul class="simple">
<li><p>Do not use BREAK, CLOSE, JOB, OPEN, READ, USE, WRITE, LOCK, HANG, and ZSYSTEM as they violate the ACID principal of Isolation. Using these commands inside a transaction may lead to longer than usual response time, high CPU utilization, repeat execution due to transaction restart, and/or TPNOTACID messages in the operator log. If application logic requires their use, put them before TSTART or after TCOMMIT so that they do not interfere with the transaction processing mechanism.</p></li>
<li><p>Keep your transaction code “pure” . By “pure” we mean that you restrict code to only perform database updates (SET, MERGE, and so on). The primary purpose of a YottaDB transaction is to perform database updates that commit in entirety or do not commit at all. Perform external interaction like invoking an external call before or after the transaction.</p></li>
<li><p>Design transactions to minimize the number of regions they use, particularly update. Like keeping transactions small, this minimizes contention and improves performance.</p></li>
<li><p>Keep transactions as short as possible.</p></li>
<li><p>Code for handling errors during transactions must include a TROLLBACK. A TROLLBACK should appear as early as possible in the error handling code. You can run commands like WRITE, OPEN, etc. after TROLLBACK because the TROLLBACK releases resources held by the transaction.</p></li>
<li><p>Remember that trigger code executes within an implicit transaction. So, trigger code is always subject to transaction considerations.</p></li>
</ul>
<p>Most transaction processing systems try to have transactions that meet the “ACID” test – Atomic, Consistent, Isolated, and Durable.</p>
<p>To provide ACID transactions, YottaDB uses a technique called optimistic concurrency control. Each block has a transaction number that YottaDB sets to the current database transaction number when updating a block. Application logic, brackets transactions with TSTART and TCOMMIT commands. Once inside a transaction, a YottaDB process tracks each database block that it reads (any database block containing existing data that it intends to update has to be read first) and in process private memory keeps a list of updates that it intends to apply - application logic within the process views the database with the updates; application logic in other processes does not see states internal to the transaction. At TCOMMIT time, the process checks whether any blocks have changed since it read them, and if none have changed, it commits the transaction, making its changes visible to other processes Atomically with Isolation and Consistency (Durability comes from the journal records written at COMMIT time). Optimistic concurrency attempts to exploit the odds that two processes need access to the same resource at the same time. If the chances are small, it permits many processes to work concurrently, particularly in a system with multiple CPUs. If the changes are not small the penalty is repeated execution of the same transaction logic.</p>
<p>If one or more blocks have changed, the process reverts its state to the TSTART and re-executes the application code for the transaction. If it fails to commit the second time, it tries yet again. If it fails to commit on the third attempt, it locks other processes out of the database and executes the transaction as the sole process (that is, on the fourth attempt, it switches to a from an optimistic approach to a pessimistic one).</p>
<p>This technique normally works very well and is one of the factors that allow YottaDB to excel at transaction processing throughput.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>YottaDB uses implicit transaction processing when it needs to ensure complex operations, including spanning block actions, spanning region actions and trigger actions preserve Atomicity. Of these, triggers involve application code and therefore are most subject to the following discussion.</p>
</div>
<p>Pathological cases occur when processes routinely modify blocks that other processes have read (called “collisions”), resulting in frequent transaction restarts. Collisions can be legitimate or accidental. Importantly, the longer that a transaction is “open” (the “collision window,” when the application logic is between TSTART and TCOMMIT), the greater the probability that a collision will require a transaction restart.</p>
<p>Legitimate collisions can result from normal business activity, for example, if two joint account holders make simultaneous ATM withdrawals from a joint account. When the time an application takes to process each transaction is a minuscule fraction of a second, the probability of a collision is very low, and in the rare case where one occurs, the restart mechanism handles it well. An example with a higher probability of collision comes from commercial accounts, where a large enterprise may have tens to hundreds of accounts, individual transactions may hit multiple accounts, and during the business day many people may execute transactions against those accounts. Again, the small collision window means that collisions remain rare and the restart mechanism handles them well when they occur.</p>
<p>Legitimate (from a YottaDB point of view) collisions can also occur as a consequence of application design. For example, if an application has an application level transaction journal that every process appends to then that design will likely result in high rates of collisions, creating a pathological case where every transaction fails three times and then commits on the fourth attempt with all other processes locked out. The way to avoid these is to adjust the application design, either to use M LOCKs to gate such “hot spots” or, better, to give each process its own update space which, at some event, a single process then consolidates.</p>
<p>Accidental collisions result when two processes access unrelated data that happens to reside on the same data block (for example, some globals indexed by last name can result in an accidental collision - for two account holders whose last names start with the same letter, the global data nodes may reside in the same block). Because the path to many data blocks typically pass though one index block, data additions cause changes in index blocks and can generate accidental collisions. While it is not possible to avoid accidental collisions (especially in blocks containing metadata such as index blocks), they are typically rare and the occasional collision is handled well by the restart mechanism. Because the application is rarely in a position to efficiently prevent accidental collisions, YottaDB strongly recommends using TCOMMIT forms that allow YottaDB to use restarts and thus relieve the application logic of having to manage TRESTNOT errors. YottaDB uses the database block as the granularity for concurrency control because it is generally an efficient and successful compromise between a more granular and expensive lock and a less granular but more likely to conflict lock. It also simplifies some things by aligning with the unit of transfer to non-volatile storage.</p>
<p>Application design that keeps transactions open for long periods of time can cause pathological rates of accidental collision. When a process tries to run an entire report in a transaction, instead of the transaction taking a fraction of a second (remember that transactions are intended to be atomic), the report takes seconds or even minutes and effectively ensures collisions and restarts. Furthermore, since the probability of collisions is high, the probability of these long-running transactions executing the fourth retry (with other processes shut out) goes up, and when that happens, the system appears to respond erratically, or hang temporarily.</p>
<p>Non-isolated actions are another consideration in the design of wholesome transactions. Because M permits all language features with a transaction, an application may use actions that interact with actors outside of the transaction. Such actions violate the ACID principle of Isolation, which states that to be wholesome, a transaction must not interact with other agents or processes until it commits (see below for a more detailed discussion). While there may be reasons drawn from the larger application model that justify violations of Isolation, doing so carries risks. One problem is time: external interactions typically have a longer duration, and in the worst case, may have an indefinite duration. The JOB, LOCK, OPEN, and READ commands have an optional timeout to place time limits on external interactions as do some WRITE format arguments. The HANG command induces a potentially arbitrary delay. In addition, BREAK, WRITE, ZSYSTEM and external calls also involve external interaction. Except for WRITE and external calls, in order to minimize the potential impact of non-ACID transactions, YottaDB limits the duration of database locks for transactions that use these non-isolated commands, and records that limitation as a TPNOTACID message in the operator log. However, that time limit, managed with the ydb_tpnotacidtime environment variable, can be long enough, depending on its value, to permit noticeable processing disruptions. Further, processes denied a long lock may have trouble completing and consume system resources with repeated unsuccessful attempts. External calls are excluded from this protection because they are the domain of more sophisticated design and may actually remain isolated (see the tip below on Implementing Web Services). WRITE is currently excluded because most WRITE commands are non-blocking, but applications should avoid blocking WRITEs within a transaction. Beyond the issue of duration, because the application can repeat due to a restart or rollback because of an error or application logic, non-isolated actions require management to appropriately manage their external interactions; this is discussed in more detail below. In summary, put external interactions before or after transactions rather than within them. If the application requires a non-isolated action within a transaction, be aware of the risks, design, implement and test very carefully.</p>
<p>YottaDB provides a transaction timeout feature that interrupts long-running transactions in order to limit their impact on the system, and the consequent user perception of system erratic response times and temporary hangs. Calls to an external library, say to access a web service, can subvert the timeout mechanism when the external library uses an uninterruptable system call. If such a web service uses an adjacent server that responds immediately, the web service is wholesome. But if the web service accesses a remote server without a guaranteed short response time, then collisions may be frequent, and if a process in the fourth retry waits for a web service that never responds, it brings the entire application to a standstill.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To safely implement web services inside a transaction, an application must implement a guaranteed upper bound on the time taken by the service. The story or use case for each circumstance determines the appropriate timeout for the corresponding transaction. For example, if the web service is to authorize a transaction, there might be a 500 millisecond timeout with the authorization refused if the approval service does not respond within that time. There are two approaches to implementing web services with a timeout.For applications that call out to C code, the C code guarantee a return within a time limit, using a wrapper if necessary. YottaDB provides functions that external C code can use to implement timers. If the call is to an unknown library, or one without a way to guarantee a timeout, the external C code may need to create an intermediate proxy that can provide a timeout to YottaDB. Because web services are usually implemented by a known protocol layered on TCP/IP and YottaDB provides a SOCKET device for TCP/IP connections, implement the call out to the web service using a SOCKET device. YottaDB can then enforce the TP timeout mechanism, which it cannot for an external call, especially one that calls via a library into an uninterruptible OS service.</p>
</div>
<p>To conform with the M approach of providing maximum flexibility and, when possible, backwards compatibility with older versions of the standard, M transaction processing requires the use of programming conventions that meet the ACID test.</p>
<p>For example, some effects of the BREAK, CLOSE, JOB, OPEN, READ, USE WRITE, and ZSYSTEM commands may be observed by parties to the system. Because the effects of these commands might cause an observing process or person to conclude that a transaction executing them was in progress and perhaps finished, they violate, in theory, the principle of Isolation.</p>
<p>The LOCK command is another example. A program may attempt to use a LOCK to determine if another process has a transaction in progress. The answer would depend on the management of LOCKs within transactions, which is implementation-specific. This would therefore clearly violate the principle of Isolation. The LOCK command is discussed later in this section.</p>
<p>The simplest way to construct a transaction that meets the ACID test is not to use any commands within a transaction whose effects may be immediately “visible” outside the transaction. Unfortunately, because M applications are highly interactive, this is not entirely straightforward. When a user interaction relies on database information, one solution is for the program to save the initial values of any global values that could affect the outcome, in local variables. Then, once the interaction is over and the transaction has been initiated, the program checks the saved values against the corresponding global variables. If they are the same, it proceeds. If they differ, some other update has changed the information, and the program must issue a TROLLBACK, and initiate another interaction as a replacement.</p>
<p>Even when the “visible” commands appear within a transaction, an M application may provide wholesome operation by relying on additional programming or operating conventions.</p>
<p>A program using M LOCKs to serialize transactions relies on properly designed and universally followed LOCKing conventions to achieve Isolation with respect to database operations. We recommend using transaction processing instead of M LOCKs.</p>
<p>In YottaDB the Durability aspect of the ACID properties relies on the journaling feature. When journaling is on, every transaction is recorded in the journal file as well as in the database. The journal file constitutes a serial record of database actions and states. It is always written before the database updates and is designed to permit recovery of the database if the database should be damaged. By default, when a process commits a transaction, it does not return control to the application code until the transaction has reached the journal file. The exception to this is that when the TSTART specifies TRANSACTIONID=”BATCH” the process resumes application execution without waiting for the file system to confirm the successful write of the journal record. The idea of the TRANSACTIONID=”BATCH” has nothing inherently to do with “batch” processing - it is to permit maximum throughput for transactions where the application has its own check-pointing mechanism, or method of recreating the transaction in case of a failure. The real durability of transactions is a function of the durability of the journal files. Putting journal files on reliable devices (RAID with UPS protection) and eliminating common points of failure with the path to the database (separate drives, controllers cabling) improve durability. The use of the replication feature can also improve durability by moving the data to a separate site in real time.</p>
<p>Attempting to QUIT (implicitly or explicitly) from code invoked by a DO, XECUTE, or extrinsic after that code issued a TSTART not yet matched by a TCOMMIT, produces an error. Although this is a consequence of the RESTART capability, it is true even when that capability is disabled. For example, this means that an XECUTE containing only a TSTART fails, while an XECUTE that performs a complete transaction succeeds.</p>
</section>
<section id="tp-performance">
<h3><a class="toc-backref" href="langfeat.html#id81">TP Performance</a><a class="headerlink" href="langfeat.html#tp-performance" title="Permalink to this heading">¶</a></h3>
<p>To achieve the best YottaDB performance, transactions should:</p>
<ul class="simple">
<li><p>be as short as possible</p></li>
<li><p>consist, as much as possible, only of global updates</p></li>
<li><p>be SERIAL with no associated LOCKs</p></li>
<li><p>have RESTART enabled with a minimum of local variables protected by a restart portion of the TSTART argument.</p></li>
<li><p>Large concurrent transactions using TCOMMIT may result in repeated and inefficient attempts by competing processes to capture needed scarce resources, resulting in poor performance.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TSTART ():SERIAL
SET (ACCT,^M(0))=^M(0)+1
SET ^M(ACCT)=PREC,^PN(NAM)=ACCT
TCOMMIT
</pre></div>
</div>
<p>This transaction encapsulates these two SETs. The first increments the tally of patients registered, storing the number in local variable ACCT for faster access in the current program, and in global variable ^M(0). The second SET stores a patient record by account number and the third cross-references the account number with the patient name. Placing the SETs within a single transaction ensures that the database always receives either all of the SETs or none of them, thus protecting database integrity against process or system failure. Similarly, another concurrent process, whether using transactions or not, never finds one of the SETs in place without also finding the other one.</p>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TSTART ():SERIAL
IF $TRESTART&gt;3 DO QUIT
.TROLLBACK
.WRITE !,&quot;Too many RESTARTs&quot;
.QUIT
SET (NEXT,^ID(0))=^ID(0)+1
SET ^ID(NEXT)=RECORD,^XID(ZIP,NEXT)=&quot;&quot;
TCOMMIT
</pre></div>
</div>
<p>This transaction will automatically restart if it cannot serialize the SETs to the database, and will terminate with a TROLLBACK if more than 3 RESTARTs occur.</p>
<p>YottaDB provides a way to monitor transaction restarts by reporting them to the operator logging facility. If the environment variable ydb_tprestart_log_delta is defined, YottaDB reports every Nth restart where N is the numeric evaluation of the value of ydb_tprestart_log_delta. If the environment variable ydb_tprestart_log_first is defined, the restart reporting begins after the number of restarts specified by the value of ydb_tprestart_log_first. For example, defining both the environment variable to the value 1, causes all TP restarts to be logged. When ydb_tprestart_log_delta is defined, leaving ydb_tprestart_log_first undefined is equivalent to giving it the value 1.</p>
<p>Here is an example message:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%YDB-I-TPRESTART, Database /gbls/dtx/dtx.dat; code: L; blk: 0x00BA13DD in glbl: ^DTX; pvtmods: 0, blkmods: 1, blklvl: 1, type: 4, readset: 3, writeset: 1, local_tn: 0x00000000000002D0, zpos: LABEL+108^ROUTINENAME
</pre></div>
</div>
<ul class="simple">
<li><p>pvtmods - Is always less than or equal to blkmods. This means it can be 1 only if “blkmods” is also 1. If it is 1, it means that process P1 was planning to UPDATE (not just READ) the block number (indicated as “blk: …” in the TPRESTART message) as part of its TP transaction.</p></li>
<li><p>blkmods - Is either 1 or 0. 1 implies the transaction restarted because this process (P1) is attempting to READ/UPDATE a block that has concurrently been updated by another process (P2) since P1 access the block as part of its TP transaction. This means the “code: …” output in the TPRESTART message will have L as the last letter. 0 implies the restart occurred because of a different reason. The “code: …” then has something other than “L” as the last letter. Note that each letter in “code: …” corresponds to the failure code in each try/retry in the order of occurrence.</p></li>
<li><p>blklvl - Is the level in the GDS structure of the block (“blk: …” field in the TPRESTART message) that caused the TP restart.</p></li>
<li><p>type - A value of 0,1,2,4 shows the restart occurred in the TP transaction BEFORE executing TCOMMIT; whether it is a 0 or 1 or 2 or 4 should not matter to the user. These values would typically be used for debugging by your YottaDB support channel. A value of 3 shows the restart occurred at TCOMMIT time.</p></li>
<li><p>readset - The number of GDS blocks that are accessed as part of this TP transaction in the region containing the global (“glbl: …” in the TPRESTART message).</p></li>
<li><p>writeset - Out of the readset number, the number of GDS blocks this process was attempted to UPDATE as part of this TP transaction in the region containing the global (“glbl: …” in the TPRESTART message).</p></li>
<li><p>local_tn - This is a never-decreasing counter (starting at 1 at process startup) incremented for every new TP transaction, TP restart, and TP rollback. Two TPRESTART messages by the same process should never have the same value of local_tn. The difference between the local_tn values of two messages from the same process indicates the number of TP transactions done by that process in the time interval between the two messages.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use VIEW [NO]LOGT[PRESTART][=intexpr] to enable or disable the logging of TPRESTART messages. Note that you can use the ydb_tprestart_log_delta and ydb_tprestart_log_first environment variables to set the frequency of TPRESTART messages. Use VIEW [NO]LOGN[ONTP][=intexpr] to enable or disable the logging of NONTPRESTART messages. This facility is the analog of TPRESTART tracking, but for non-TP mini-transacstions. Note that you can use the ydb_nontprestart_log_delta and ydb_nontprestart_log_first environment variables to set the frequency of the NONTPRESTART messages.For more information, refer to <a class="reference external" href="commands.html#keywords-in-view-command">“Key Words in VIEW Command”</a> and the <a class="reference external" href="../AdminOpsGuide/basicops.html#env-vars">Environment Variables</a> section of the Administration and Operations Guide.</p>
</div>
</section>
<section id="tp-example">
<h3><a class="toc-backref" href="langfeat.html#id82">TP Example</a><a class="headerlink" href="langfeat.html#tp-example" title="Permalink to this heading">¶</a></h3>
<p>Here is a transaction processing example that lets you exercise the concept. If you use this example, be mindful that the functions “holdit” and “trestart” are included as tools to allow you access to information within a transaction which would normally be hidden from users. These types of functions would not normally appear in production code. Comments have been inserted into the code to explain the function of various segments.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>trans
;This sets up the program constants
;for doit and trestart
new
set $piece(peekon,&quot;V&quot;,51)=&quot;&quot;
set $piece(peekon,&quot;V&quot;,25)=&quot;Peeking inside Job &quot;_$job
set $piece(peekoff,&quot;^&quot;,51)=&quot;&quot;
set $piece(peekoff,&quot;^&quot;,25)=&quot;Leaving peeking Job &quot;_$job
;This establishes the main loop
set CNFLTMSG=&quot;Conflict, please reenter&quot;
for read !,&quot;Name: &quot;,nam quit:&#39;$length(nam) do
.if &quot;?&quot;=nam do quit
..write !,&quot;Current data in ^trans:&quot;,! do:$data(^trans) quit
...zwrite ^trans
.for set ok=1 do quit:ok write !,$char(7),CNFLTMSG,$char(7),!
..set old=$get(^trans(nam),&quot;?&quot;)
..if &quot;?&quot;=old write !,&quot;Not on file&quot; do quit
...;This is the code to add a new name
...for do quit:&quot;?&quot;&#39;=data
....read !,&quot;Enter any info using &#39;#&#39; delimiter: &quot;,!,data
...if &quot;&quot;=data write !,&quot;No entry made for &quot;,nam quit
...TSTART ():SERIAL if $$trestart ;$$trestart for demo
...if $data(^trans(nam)) set ok=^trans(nam)=data TROLLBACK quit
...set ^trans(nam)=data
...TCOMMIT:$$doit ;$$doit for demo
..;This is the beginning of the change and delete loop
..for do quit:+fld=fld!&#39;$length(fld) write &quot; must be numeric&quot;
...write !,&quot;Current data: &quot;,!,old
...read !,&quot;Piece no. (negative to delete record) : &quot;,fld
..if &#39;fld write !,&quot;no change made&quot; quit
..;This is the code to delete a new name
..if fld&lt;0 do quit ; delete record
...for do quit:&quot;YyNn&quot;[x
....write !,&quot;Ok to delete &quot;,nam,&quot; Y(es) or N(o) &lt;N&gt;? &quot;
....read x set x=$extract(x)
...if &quot;Yy&quot;&#39;[x!&#39;$length(x) write !,&quot;No change made&quot; quit
...TSTART ():SERIAL if $$trestart ;$$trestart for demo
...if $get(^trans(nam),&quot;?&quot;)&#39;=old TROLLBACK set ok=0 quit
...kill ^trans(nam)
...TCOMMIT:$$doit; $$doit for demo
..;This is the code to change a field
..for read !,&quot;Data: &quot;,data quit:(&quot;?&quot;&#39;=data)&amp;(data&#39;[&quot;#&quot;) do
...write &quot; must not be a single &#39;?&#39; or contain any &#39;#&#39;&quot;
..TSTART ():SERIAL if $$trestart ;$$trestart for demo
..if &#39;$data(^trans(nam)) set ok=0 TROLLBACK q
..if $piece(^trans(nam),&quot;#&quot;,fld)=$piece(old,&quot;#&quot;,fld) do quit
...set ok=$piece(^trans(nam),&quot;#&quot;,fld)=data TROLLBACK
..set $piece(^trans(nam),&quot;#&quot;,fld)=data
..TCOMMIT:$$doit; $$doit for demo
quit
doit()
;This inserts delay and an optional
;rollback only to show how it works
write !!,peekon do disp
for do quit:&quot;CR&quot;[act
.read !,&quot;C(ommit), R(ollback), or W(ait) &lt;C&gt;? &quot;,act
.set act=$translate($extract(act),&quot;cr&quot;,&quot;CR&quot;)
.if &quot;?&quot;=act do disp
if &quot;R&quot;=act TROLLBACK write !,&quot;User requested DISCARD&quot;
write !,peekoff,!
quit $TLEVEL
trestart()
;This is only to show what is happening
if $TRESTART do
.write !!,peekon,!,&quot;&gt;&gt;&gt;RESTART&lt;&lt;&lt;&quot;,! do disp write !,peekoff,!
quit 1
disp
write !,&quot;Name: &quot;,nam
write !,&quot;Original data: &quot;,!,old,!,&quot;Current data: &quot;
write !,$get(^trans(nam),&quot;KILLED!&quot;)
quit
</pre></div>
</div>
<p>Generally, this type of program would be receiving data from multiple sessions into the same global.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="opdebug.html" class="btn btn-neutral float-left" title="4. Operating and Debugging in Direct Mode" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="commands.html" class="btn btn-neutral float-right" title="6. Commands" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2021, YottaDB LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
<hr/>
<!-- DDG search widget,@author Juri Wornowitski,@version 2.0,@link https://www.plainlight.com/ddg --><div id="widdget" style="width:100%;margin:10px 0;"><style type="text/css">#widdget input {display:block;height:30px;padding:4px;outline:none;border:1px solid #8d8d8d;border-right:0;box-sizing:border-box;border-radius:3px 0 0 3px;width:calc(100% - 41px);font-size:15px;} #widdget button {float:left;cursor:pointer;width:43px;height:30px;color:#fff;background-image:linear-gradient(#7f72ca,#554492);border:0;border-radius:0 3px 3px 0;} #widdget button:active {background-image:linear-gradient(#002387,#002357);} #widdget button:focus {outline:none;}</style><form style="position:relative" onsubmit="this.elements[0].click();return false;"><div style="float:right;position:absolute;top:0;right:-2px;z-index:3"><button type="button" onclick="var v=this.parentElement.parentElement.elements[1].value;window.open('https://duckduckgo.com?q='+encodeURIComponent(v)+'+site%3Adocs.yottadb.com&kj=p');">&#128269;</button></div><input type="text" name="que" placeholder="Search documents with DuckDuckGo" /></form></div>
 


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>